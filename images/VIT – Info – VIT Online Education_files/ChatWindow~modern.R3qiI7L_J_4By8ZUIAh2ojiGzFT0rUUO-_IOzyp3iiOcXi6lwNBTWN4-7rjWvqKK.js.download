(window.siqcwJsonp=window.siqcwJsonp||[]).push([["ChatWindow"],{"03df":function(e,t,s){},"0439":function(e,t,s){"use strict";s("c24c")},"05da":function(e,t,s){},"09a8":function(e,t,s){"use strict";var i=(s("ac6a"),s("fa7d")),a=s("76c4");const n=()=>Promise.all([s.e("AttachmentPreview~CallBodyWrapper~ChatInitiator~ChatWindow~SelfService~TraditionalForm"),s.e("AttachmentPreview")]).then(s.bind(null,"4a74"));var o={name:"Attachments",props:{iconClass:{type:String,default:"siqico-attach"},isMultipleFiles:{type:Boolean,default:!0},onShareHandler:{type:Function,default:()=>{}},fileValidationHandler:Function,limit:{type:Object,default:()=>{}},allowedFormats:{type:Array,default:()=>[]}},data(){return{attachmentProps:{attachments:[],addFileHandler:this.attachFile,onShareHandler:()=>this.onShareHandler(this.attachmentProps.attachments),errorObj:{msg:""},limit:this.limit,allowedFormats:this.allowedFormats,closeHandler:this.closeDialogHandler}}},computed:{selectedFiles(){return this.attachmentProps.attachments.map(({file:e})=>e)},selectedFilesLength(){return this.selectedFiles.length}},methods:{onFileChange({target:e}){let t=Array.from(e.files);if(e.value=null,this.fileValidationHandler)return this.handleFileUpload(t);this.validateAndUploadFiles(t)},validateAndUploadFiles(e){e=Array.from(e);let t=[...e,...this.selectedFiles];if(!Object(a.a)(t)){let e=this.$doI18N("file.sizelimit","50MB");return this.selectedFilesLength?this.setErrorMessage(e):this.$showBanner(e)}Object(a.c)(e,!this.selectedFilesLength).then(({filteredFiles:e,errMsg:t})=>{e.length&&this.uploadFiles(e),t&&this.setErrorMessage(t)}).catch(e=>{this.setErrorMessage(e)})},uploadFiles(e){e.forEach(e=>this.attachmentProps.attachments.push({file:e,id:Object(i.a)()})),!this.isFilePreviewShown&&this.showPreviewDialog()},showPreviewDialog(){this.isFilePreviewShown=!0,this.$showDialog(this.attachmentProps,n)},closeDialogHandler(){this.clearAttachments(),this.$closeDialog(),this.isFilePreviewShown=!1},clearAttachments(){this.attachmentProps.attachments=[]},attachFile(){n(),this.$refs.fileInput.click()},setErrorMessage(e){this.attachmentProps.errorObj.msg=e},handleFileUpload(e){let{selectedFilesLength:t}=this,s=e.length;if(this.limit.max<t+s){let e=this.$doI18N("file.uploadlimit",this.limit.max);return void(t?this.setErrorMessage(e):this.$showBanner(e))}let{validFiles:i,errorMsg:a}=this.fileValidationHandler(e,this.selectedFiles);i.length||t?(i.length!==s&&this.setErrorMessage(a),this.uploadFiles(i)):this.$showBanner(a)}}},r=o,l=(s("7aed"),s("2877")),c=Object(l.a)(r,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"posrel"},[s("Icon",{directives:[{name:"title",rawName:"v-title:left",value:"siq.sharefile",expression:"'siq.sharefile'",arg:"left"}],class:e.iconClass,attrs:{clickHandler:e.attachFile,a11yArg:"icon",ariaValue:{label:"siq.sharefile"},"data-zsqa":"attachment_btn"}}),s("input",{ref:"fileInput",staticClass:"attachment-input hide",attrs:{type:"file",multiple:e.isMultipleFiles,"data-zsqa":"attachment_input"},on:{change:e.onFileChange}}),e._t("post-slot")],2)},[],!1,null,"b467909a",null);t.a=c.exports},"09b0":function(e,t,s){"use strict";s.d(t,"c",function(){return n}),s.d(t,"b",function(){return o});var i=s("2b0e"),a=s("8db4");let n=function(e,t){this.removeBotTyping();i.a.set(this,"typingId",Date.now()+"1"),e&&(this.typingTimeout=setTimeout(()=>{this.removeBotTyping(),null==t||t()},e))},o=function(){clearTimeout(this.typingTimeout),i.a.delete(this,"typingId"),delete this.typingTimeout};t.a={beforeMount(){this.initTypingWatchers()},provide(){return{isBotTypingShown:()=>this.chatDetail.typingId}},watch:{isBotChat(e,t){!t&&e&&this.initTypingWatchers()}},methods:{initTypingWatchers(){if(!this.isBotChat||this.isClosedChat)return void o.call(this.chatDetail);let e="handleBotTyping";this.$eventBus.$on(e,e=>{e.chatId===this.chatId&&this.handleBotTyping(e.typing)}),this.$once("hook:beforeDestroy",()=>{this.$eventBus.$off(e)}),Object(a.g)(this.chatStatus)&&!this.chatDetail.isBotTrigger&&this.handleBotTyping(!0)},handleBotTyping(e){let{chatDetail:t}=this;if(t.updateTypingTimer||(t.updateTypingTimer=n,t.removeBotTyping=o),!this.isBotChat||!e||t.forwardTime)return t.removeBotTyping();t.updateTypingTimer(),this.scrollToBottom(!0)}}}},"0e46":function(e,t,s){"use strict";s("4290")},"111b":function(e,t,s){},1387:function(e,t,s){"use strict";t.a=(()=>{let e;return{play(t){this.stopCurrentMedia(),e=t,t.play()},stop(t){e===t&&this.stopCurrentMedia()},stopCurrentMedia(){e&&(e.pause(),e=void 0)}}})()},"13f5":function(e,t,s){"use strict";s.d(t,"a",function(){return o});var i=s("387f"),a=s("24fa"),n=s("23b2");const o={data(){let e=this.$doI18N;return{defaultConsent:{audio:e("siqcw.callrecording.consent"),screen:e("siqcw.ssconsent")},showCallConsent:!1,cnstType:"",consentSuccess:()=>{},consentFailure:()=>{}}},methods:{getConsentContent(){return"audio"==this.cnstType?this.recordingDetails.audioConsent||this.defaultConsent.audio:this.recordingDetails.screenConsent||this.defaultConsent.screen},getConsentAcceptTitle(){return"audio"==this.cnstType?this.$doI18N("gdpr.accept"):this.$doI18N("siq.share")},resetConsentProps(){this.showCallConsent=!1,this.cnstType="",this.consentSuccess=()=>{},this.consentFailure=()=>{}},setConsentGiven(){Object(a.d)("audio"==this.cnstType?i.a.audio:i.a.screen,!0)},handleConsent({success:e,failure:t,type:s,window:i}){this.consentWindow===i&&(this.showCallConsent=!0,this.cnstType=s,this.consentSuccess=e,this.consentFailure=t)}},computed:{consentProps(){return{title:"",popupClass:"p20",desc:this.getConsentContent(),ctaButton:{text:this.getConsentAcceptTitle(),className:"siqcw-btn",clickHandler:()=>{this.consentSuccess(),this.setConsentGiven(),this.resetConsentProps()}},onClose:()=>{this.consentFailure(),this.resetConsentProps()}}},recordingDetails:()=>n.a.getRecordingDetails()},beforeMount(){this.$eventBus.$on("getConsent",this.handleConsent)},beforeDestroy(){this.$eventBus.$off("getConsent",this.handleConsent)}}},1436:function(e,t,s){"use strict";var i={name:"ConversationSenderName",props:{name:{type:String,required:!0},onNameEdit:Function},inject:["hasHeaderOption"],computed:{allowNameEdit(){return!this.hasHeaderOption&&this.onNameEdit}}},a=(s("45be"),s("2877")),n=Object(a.a)(i,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",e._g({staticClass:"w100 siqcw-name-cont posrel mR5",class:{curP:e.allowNameEdit},attrs:{"data-zsqa":"name_edit_section"}},e.allowNameEdit?{click:e.onNameEdit}:{}),[s("div",{directives:[{name:"title",rawName:"v-title.isElips",value:e.name,expression:"name",modifiers:{isElips:!0}}],staticClass:"font13 siqcw-name-div w100 elips"},[e._v(e._s(e.name))]),e.allowNameEdit?s("Icon",{staticClass:"siqico-edit siqcw-name-edit posabs ifont11 clr6"}):e._e()],1)},[],!1,null,null,null);t.a=n.exports},1687:function(e,t,s){"use strict";s("c22f")},1734:function(e,t,s){},"174d":function(e,t,s){"use strict";s("50c2")},"194a":function(e,t,s){},"1ce0":function(e,t,s){"use strict";var i={name:"ConversationMessageBodyWrap"},a=s("2877"),n=Object(a.a)(i,function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"flex fdirection justifyE h100 ovrflw-hid posrel siq-fadein"},[e._t("default")],2)},[],!1,null,null,null);t.a=n.exports},"1fe0":function(e,t,s){},"208f":function(e,t,s){},2340:function(e,t,s){"use strict";s("111b")},"24af":function(e,t,s){},2800:function(e,t,s){},2819:function(e,t,s){"use strict";s("c7b0")},2949:function(e,t,s){"use strict";var i=s("cd91"),a={name:"ConversationRatingEmoji",props:{emojiKey:{type:String,required:!0},isSelected:Boolean},data(){return{emojiHtml:i.a.replaceUnicode("neutral"===this.emojiKey?":neutral_face:":":"+this.emojiKey+":")}}},n=(s("d09b"),s("2877")),o=Object(n.a)(a,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{class:["curP emoji-rating",{sel:e.isSelected}],attrs:{"data-zsqa":e.emojiKey},domProps:{innerHTML:e._s(e.emojiHtml)}}),e._t("post-slot")],2)},[],!1,null,"208a79b8",null);t.a=o.exports},"29ab":function(e,t,s){"use strict";s("4168")},"2b1e":function(e,t,s){},"2d27":function(e,t,s){},"2e2a":function(e,t,s){},"2f24":function(e,t,s){},"30a2":function(e,t,s){"use strict";s("898a")},3124:function(e,t,s){},3437:function(e,t,s){"use strict";s("4516")},"344d":function(e,t,s){"use strict";s("9aec")},"357e":function(e,t,s){"use strict";s("2f24")},"35b8":function(e,t,s){"use strict";s("3124")},"390b":function(e,t,s){"use strict";s.d(t,"a",function(){return r});var i=s("4360"),a=s("e6fd"),n=s("133b");const o=e=>"ace/mode/"+e;class r{constructor(e){this.params=e,this.fullContent=e.content||"",this.lineLimit=e.lineLimit||8,this.appendEditorScript().then(()=>{window.ace?this.init():setTimeout(()=>{this.init()},300)})}appendEditorScript(){return new Promise(e=>{Object(n.b)(a.Y+"/ace.js","ace_script",e)})}init(){let e=this.params;ace.config.set("basePath",a.Y),this.editor=ace.edit(e.id,{...e.options,theme:"ace/theme/"+(i.a.getters["embedstore/isExceptionalTheme"]?"solarized_dark":"crimson_editor"),mode:o(e.options.mode),highlightActiveLine:!1,printMargin:!1}),ace.EditSession.prototype.$useWorker=!1,this.editor.renderer.$cursorLayer.element.style.display="none",this.setLimitedContent(),this.editor.renderer.once("afterRender",()=>{"function"==typeof this.params.onReady&&this.params.onReady(this.editor)})}setLimitedContent(){const e=this.getLimitedLines(this.fullContent,this.lineLimit);this.editor.setValue(e,-1),this.editor.setReadOnly(!0)}getLimitedLines(e,t){return e.split("\n").slice(0,t).join("\n")}showFullContent(){this.editor.setValue(this.fullContent,-1)}destroy(){var e;null===(e=this.editor)||void 0===e||e.destroy()}}},4048:function(e,t,s){"use strict";s("68dc")},"40e2":function(e,t,s){"use strict";s("1fe0")},4168:function(e,t,s){},4290:function(e,t,s){},4352:function(e,t,s){"use strict";s("5463")},4516:function(e,t,s){},"45be":function(e,t,s){"use strict";s("24af")},"46b7":function(e,t,s){},"48de":function(e,t,s){"use strict";s("63e5")},"4b5f":function(e,t,s){"use strict";var i=(s("ac6a"),{name:"IntersectionObserver",props:{root:{type:[Element],default:null},rootMargin:{type:[String,Number],default:"200px 0px 200px 0px"},threshold:{type:[Array,Number],default:0},onIntersection:{type:Function,default:()=>{}}},data:()=>({observer:null}),mounted(){this.setObserver()},beforeDestroy(){this.unobserve()},methods:{setObserver(){if(this.observer)return;let e={root:this.root,rootMargin:this.rootMargin,threshold:this.threshold};this.observer=new IntersectionObserver(([e])=>{e.isIntersecting&&this.onIntersection(this.unobserve,e)},e),this.observer.observe(this.$el)},unobserve(){var e;null===(e=this.observer)||void 0===e||e.unobserve(this.$el),this.observer=null}}}),a=i,n=s("2877"),o=Object(n.a)(a,function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",[e._t("default")],2)},[],!1,null,null,null),r=o.exports;var l={name:"ImageFile",props:{imgSrc:{type:String,required:!0},className:{type:String,default:"cur-zoomin"},alt:{type:String,default:""},afterLoad:{type:Function,default:()=>{}},type:{type:String,default:""},dataSrc:{type:String,default:""},containerClass:{type:String,default:"img-container"},loaderClass:String,clickHandler:Function},data(){return{isImgLoaded:!1,intersectionProps:{onIntersection:this.onIntersection,root:null,ref:"observer"},imgUrl:"",hasError:!1}},methods:{onImgLoad(){this.isImgLoaded=!0,this.imgUrl=this.imgSrc,this.afterLoad()},onErrorHandler(){this.isImgLoaded=!0,this.hasError=!0},onImageClick(e){e.stopPropagation,this.clickHandler(e)},onIntersection(e,t){if(!e.isIntersecting)return;let{image:s}=this.$refs;s&&s.removeAttribute("loading"),t()}},watch:{imgSrc(e){this.imgUrl=e}},beforeMount(){let{dataSrc:e,type:t,imgSrc:s}=this;this.imgUrl=e?((e,t)=>e&&t?`data:${e};base64,${t}`:"")(t,e):s},components:{IntersectionObserver:r}},c=l,d=(s("4048"),Object(n.a)(c,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("IntersectionObserver",e._b({staticClass:"wh100",class:e.containerClass},"IntersectionObserver",e.intersectionProps,!1),[e.imgSrc&&!e.hasError?s("img",e._g({directives:[{name:"aria",rawName:"v-aria:img",value:{label:e.alt},expression:"{label: alt}",arg:"img"}],ref:"image",staticClass:"siqcw-image",class:e.className,attrs:{loading:"lazy",src:e.imgUrl||e.imgSrc,alt:e.alt,"data-zsqa":"image"},on:{load:e.onImgLoad,error:e.onErrorHandler}},e.clickHandler?{click:e.onImageClick}:{})):e._e(),e.hasError?s("div",{staticClass:"textC vh-abs-center flexM fdirection media-par-div",attrs:{"data-zsqa":"brokenimg_section"}},[s("icon",{staticClass:"siqico-img ifont30 clr6 broke-icn"})],1):e._e(),e.isImgLoaded?e._e():s("div",{staticClass:"vh-abs-center wh100 flexM media-par-div"},[s("div",{staticClass:"loading-container"},[s("loading-icon",{attrs:{className:e.loaderClass}})],1)]),e._t("post-slot")],2)},[],!1,null,null,null));t.a=d.exports},"4b9f":function(e,t,s){"use strict";s("208f")},"4d14":function(e,t,s){"use strict";s.r(t);var i=(s("ac6a"),s("2f62")),a=s("8db4"),n=s("0970"),o=s("ef71"),r=s("8b34"),l=s("24fa"),c=s("e6fd"),d=s("ce23"),h=s("b9b5"),m=s("4362"),u=s("c153"),p={name:"ConversationVisitorForm",props:{onClose:Function,isEdit:Boolean,onSubmit:Function},data:()=>({isSaving:!1,isLoading:!0}),computed:{...Object(i.d)("embedstore",["visitorInfo","embedDetail"])},methods:{handleFormLoad(){this.isLoading=!1},handleSubmit(){let{form:e}=this.$refs;if(!e.hasValidFields())return;let t=this.visitorInfo,s={name:t.name,email:t.email,phone:t.phone,first_name:t.first_name,last_name:t.last_name,salutation:t.salutation},i=e.fieldValues;if(Object(a.kb)(i.salutation)||(i.salutation="None"),this.isEdit&&Object(h.a)(s,i))return void this.onClose();this.embedDetail.dynamicConf.isFirstNameFlowEnabled?delete i.name:(delete i.first_name,delete i.last_name);let n={department_id:e.departmentId,visitor:i},o=e.isSubscribed;"boolean"==typeof o&&(e.isEdit?n.visitor.subscribe=o:n.subscribe=o),!this.isEdit&&e.customFieldValues&&(n.customer_info={...t.info,...e.customFieldValues});let r=this.onSubmit(n);r?(this.isSaving=!0,r.then(this.onClose).finally(()=>{this.isSaving=!1})):this.onClose()}},components:{ConversationForm:m.a,Button:u.a}},g=p,f=(s("ad5b"),s("2877")),v=Object(f.a)(g,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ui-transitions",{attrs:{enterToClass:"siq-fadein",leaveToClass:"siq-fadeout"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],staticClass:"siqcw-vis-form posabs wh100 bgWhite"},[s("ConversationForm",{ref:"form",staticClass:"h100 p15 pT20",attrs:{isEdit:e.isEdit,ignoreQuestion:!0},on:{formLoad:e.handleFormLoad,close:e.onClose,focus:e.handleSubmit},scopedSlots:e._u([{key:"field",fn:function(){return[s("div",{staticClass:"flex justifyE mT10"},[s("Button",{attrs:{text:"siq.cancel",className:"siqcw-btn-cancel mR10",clickHandler:e.onClose}}),s("Button",{attrs:{text:e.isEdit?"siq.update":"siq.continue",className:"siqcw-btn",clickHandler:e.handleSubmit,loading:e.isSaving}})],1)]},proxy:!0}])})],1)])},[],!1,null,"313a39d5",null),C=v.exports,b=s("9f0e"),y=s("76c4"),_=s("b6be");let D=e=>{let t=e.split("").map(Number),s=0,i=t.length,a=i%2;for(let e=0;e<t.length;e++){let i=t[e];e%2==a&&(i*=2),i>9&&(i-=9),s+=i}if(!(s%10)){let t=e.split(""),s="XXX-XXX-XXX-";switch(i){case 13:return t.splice(0,9,s),t.join("");case 14:return t.splice(0,10,s),t.join("");case 15:return t.splice(0,11,s),t.join("");case 16:return t.splice(0,12,s),t.join("")}}return!1};var w=s("05a0"),I=s("a2eb"),M=s("1549"),T=s("09a8"),S=s("c1f3"),k=s("392d"),F=s("9519"),j={computed:{...Object(i.d)(["sessionId"])},inject:["dispatchAction"],beforeMount(){this.sendPredictionMessage=this.$throttle(this.sendPredictionMessage,3e3),this.dispatchTypingStatus=this.$debounce(this.dispatchTypingStatus,3e3)},methods:{sendPredictionMessage(){this.predictionValue=this.value,this.dispatchAction("sendPredictionMessage",{message:this.predictionValue.replace(/[0-9]/g,"*")})},dispatchTypingStatus(){let{value:e}=this;e&&this.predictionValue!==e&&this.sendPredictionMessage(),this.dispatchAction("sendTypingStatus",{status:e?"entered":"idle"})},handleInput(e){this.value=e,this.handleCreditCard(!1),Object(a.ob)(this.chatId),this.composerDetail.error="",this.updateReadReceipt(),this.isLiveOperatorChat&&this.sessionId&&(e&&this.sendPredictionMessage(),this.dispatchTypingStatus(),this.setDraftValue(e))}}},E=s("2900"),q={data:()=>({isComposerDisabled:!1,composerPlaceholder:""}),inject:["getLastMessage"],computed:{lastMessage(){return this.getLastMessage()},showComposer(){if(this.isLiveOperatorChat)return!0;let e=this.lastMessage.meta;return!(e&&e.suggestions&&e.hide_custom_message)}},created(){this.initComposerWatcher()},watch:{isComposerDisabled(e){e||(this.chatDetail.botPendingInfo&&this.$delete(this.chatDetail,"botPendingInfo"),this.$refs.input&&this.setFocus())}},methods:{initComposerWatcher(){this.composerUnWatcher=this.$watch(()=>{let{chatDetail:e}=this;return[e.typingId||e.botWaitingInfo||e.inlineform||e.visitorEdit||e.showTerms||this.isPendingChat||e.isOfflineSubmit,this.lastMessage]},this.setComposerMeta,{immediate:!0,deep:!0})},setComposerMeta([e,t]){if(this.clearScheduler(),this.isComposerDisabled=!!e||!!t.nameField||t.departmentSelection||!!t.campaignOption||this.checkIfWaitingForUserInput(t),this.isComposerDisabled){let{meta:e}=t;this.composerPlaceholder=this.$doI18N(this.getComposerPlaceHolder(e)),this.checkAndScheduleEnable(e)}},getComposerPlaceHolder(e){let t=this.visitorInfo.messagehint;return this.isPendingChat?t||"siq.message.hitenter":this.chatDetail.isOfflineSubmit?t||o.c?"offline.mobile.hint":"compos.offline.hint":e&&e.action===n.e?"siqcw.pleasewait":"msg.choose"},checkIfWaitingForUserInput(e){var t;let s=e.meta;return!(!s||s&&s.suggestions||this.isLiveOperatorChat||s.action!==n.e&&(s.allow_typing||!s.input_card&&"wait_for_user_input"!==s.behaviour||null===(t=s.input_card)||void 0===t||!t.type))},checkAndScheduleEnable(e){if(!e||e.action!==n.e)return;let t=this.lastMessage.time,s=18e4,i=Date.now()-t;i>=s?this.isComposerDisabled=!1:this.composerScheduler=setTimeout(()=>{this.isComposerDisabled=!1},s-i)},clearScheduler(){clearTimeout(this.composerScheduler)}},beforeDestroy(){this.composerUnWatcher(),this.clearScheduler()}},O={name:"ConversationComposer",mixins:[F.a,j,E.a,q],props:{chatId:{type:String,required:!0},composerDetail:{type:Object,default:()=>({})}},data(){return{value:"",showEmoji:!1,showVoiceRecorder:!1,isMobileDevice:o.c,VoiceRecorder:()=>s.e("VoiceNote").then(s.bind(null,"57da")),voiceRecorderProps:{sendRecording:this.sendVoiceNote}}},provide(){return{toggleVoiceRecorder:this.toggleVoiceRecorder}},inject:["getReplyMsgId","scrollChatBody","onMsgReply","getVisitorDetail","handlePreChatForm","handleCreditCard","handleChatFormInput","chatConfig","embedDetail"],created(){let e=this.chatDetail;this.value=e.draftValue||(e.isProactive||e.isTrigger)&&this.visitorInfo.question||"",this.initiateVoiceNote()},computed:{...Object(i.d)("embedstore",["visitorInfo"]),...Object(i.b)({hasFileShare:"embedstore/hasFileShare",hasCreditCardMask:"embedstore/hasCreditCardMask",activeChatIds:"conversationstore/activeChatIds",embedStatusPlaceHolder:"embedstore/embedStatusPlaceHolder",isExceptionalTheme:"embedstore/isExceptionalTheme",ongoingCallDetail:"conversationstore/ongoingCallDetail"}),isBotAvailable(){return this.isLiveChat&&!this.isBotBusy},hasEmoji(){return c.e?this.chatConfig.share_emoji:this.embedDetail.showEmoji&&this.isBotAvailable&&!this.isComposerDisabled&&!this.composerDetail.placeHolder&&!this.isMobileDevice},placeHolder(){switch(!0){case!!this.composerDetail.placeHolder:return this.composerDetail.placeHolder;case this.isComposerDisabled:return this.composerPlaceholder;case this.isClientMissed:return"compos.req.hint";default:return this.visitorInfo.messagehint||(this.isLiveChat?"siq.message.hitenter":this.embedStatusPlaceHolder)}},hasFileUpload(){let e=this.lastMessage.meta||{};return this.hasFileShare&&this.isBotAvailable&&!(e.allow_typing||"text"===e.type)},hasVoiceNote(){return c.e?this.chatConfig.allow_voice_note:this.embedDetail.showVoiceNote&&(!this.isBotChat&&this.isLiveChat||this.isClientMissed||this.isBotBusy)&&!this.value},isRestrictVisitorInputEnabled(){var e;return(null===(e=this.embedDetail)||void 0===e||null===(e=e.dynamicConf)||void 0===e?void 0:e.isRestrictVisitorInputEnabled)||!1},textAreaProps(){return this.hasCharLimitValidation?{maxLength:n.t}:{}},hasCharLimitValidation(){let e=this.lastMessage.meta||{};return!!(this.isRestrictVisitorInputEnabled&&e.allow_typing&&"text"!==e.type&&this.isBotChat)},charCount(){return n.t-this.value.trim().length}},watch:{chatId(){this.showVoiceRecorder=!1,this.setFocus()},placeHolder(){this.$eventBus.$emit("onPlaceHolderChange",{placeholder:this.placeHolder,isComposerDisabled:this.isComposerDisabled})}},methods:{initiateVoiceNote(){let{voiceNote:e={}}=this.chatDetail;this.chatDetail.voiceNote=e,this.showVoiceRecorder=e.dataView},handleEnter(e,t){t.shiftKey||Object(a.gb)(t)&&!this.composerDetail.handleInput||(t.preventDefault(),this.sendMessage())},handleFileUpload(e){let{attachment:t}=this.$refs;t&&t.validateAndUploadFiles(e)},sendMessage(){let e=this.value;if(this.isPendingChat||!e||this.chatDetail.isOfflineSubmit)return;if(o.c&&w.a.isEmbedFeatureConfEnabled("widgetEnhancement")&&this.$refs.input&&this.$refs.input.setInputFocus(),this.composerDetail.handleInput)return this.handleChatFormInput(e);if(Object(a.b)(this.chatDetail))return this.handlePreChatForm(e);let t=this.getCreditCardMaskedMessage(e),s=(e,t,s)=>this.dispatchMessage("sendTextMessage",{text:e,type:t,tempMsg:s});if(!t)return s(e,n.r.text);this.handleCreditCard(!0,i=>{this.handleCreditCard(!1),s(e,i?n.r.creditcard:n.r.text,i?t:"")})},sendVoiceNote(e){this.handleAttachments([{file:e,att_type:n.u,dataUrl:URL.createObjectURL(e)}])},setDraftValue(e){this.chatDetail.draftValue=e},toggleVoiceRecorder(){return this.showVoiceRecorder=!this.showVoiceRecorder},closeVoiceRecorder(){this.toggleVoiceRecorder(),this.chatDetail.voiceNote={}},getCreditCardMaskedMessage(e){return this.hasCreditCardMask&&(e=>{var t=e.match(/\b(((\d)+([-]|\s)*)+(\d)+)\b/g);if(!t||!t.length)return"";let s=!1;for(var i=0;i<t.length;i++){var a=t[i].match(/\d+/g).join(""),n=a.length;if(!(n<13||n>16)){var o=D(a);o&&(s=!0,e=e.replace(t[i],o))}}return s?e:""})(e)},handleFilePaste(e){e.clipboardData.files.length&&Object(y.c)(e.clipboardData.files).then(e=>{var t;null===(t=this.$refs.attachment)||void 0===t||t.uploadFiles(e.filteredFiles)})},clearValue(){this.value=""},toggleEmoji(e=!0){this.showEmoji=e},setFocus(){let e=this.$refs.input;e&&e.setFocus()},handleAttachments(e){this.dispatchMessage("sendAttachments",{attachments:e})},dispatchMessage(e,t){_.a[e]({chatId:this.chatId,replyId:this.getReplyMsgId(),...t,visitorName:this.getVisitorDetail().name}).then(this.handleMissedReponse),this.handlePostMessageSend()},handlePostMessageSend(){this.clearValue(),this.setDraftValue(""),this.onMsgReply(""),this.$eventBus.$emit("handleBotTyping",!0)},handleMissedReponse(){if(!this.isClientMissed&&!this.isBotBusy)return;let e=this.chatDetail.lastMessage.message.text;if(this.isBotBusy&&e)return this.$store.dispatch("conversationstore/sendMissedLeaveMessage",{chatId:this.chatDetail.id,message:e,name:this.getVisitorDetail().name}).then(this.missedChatHandler);this.missedChatHandler()},missedChatHandler(){this.chatDetail.status=n.g.missed,this.$showBanner(Object(a.M)("busycomplete")||this.chatConfig.agents_busy.response||this.$doI18N("chat.busymsg")),this.activeChatIds.length||this.$minimize(!0,()=>{Object(a.qb)("")})}},components:{TextAreaComponent:M.a,Attachments:T.a,AsyncComponent:k.default,UnicodeEmojis:S.a,ConversationComposerWrap:I.a}},x=O,B=(s("abfa"),s("2819"),Object(f.a)(x,function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.showComposer?s("ConversationComposerWrap",{class:{error:e.composerDetail.error}},[e.showVoiceRecorder?s("AsyncComponent",{attrs:{comp:e.VoiceRecorder,compProps:{sendRecording:e.sendVoiceNote,chatId:e.chatId,audioDraft:e.chatDetail.voiceNote,closeHandler:e.closeVoiceRecorder,isDarkMode:e.isExceptionalTheme}}}):s("TextAreaComponent",e._b({ref:"input",staticClass:"font13 wh100",class:{"mobile-compose":e.isMobileDevice},attrs:{placeHolder:e.$doI18N(e.placeHolder),autoFocus:!0,onEnter:e.handleEnter,hasEmoji:e.hasEmoji,value:e.isComposerDisabled?"":e.value,onInputChange:e.handleInput,needFocusAnim:!1,disabled:e.isComposerDisabled,hasDynamicHeight:!0,onPaste:e.hasFileShare?e.handleFilePaste:null,"aria-hidden":!e.showComposer,"data-zsqa":"message_area_section"},scopedSlots:e._u([{key:"pre-main-slot",fn:function(){return[e.hasFileUpload&&e.isMobileDevice&&!e.isComposerDisabled?s("Attachments",{ref:"attachment",staticClass:"ifont18 clr6 mobile-plus",attrs:{iconClass:"siqico-plus",onShareHandler:e.handleAttachments,"data-zsqa":"conv_attachment"}}):e._e()]},proxy:!0},e.isComposerDisabled?null:{key:"pre-slot",fn:function(){return[e.hasCharLimitValidation&&e.value.length?s("span",{staticClass:"char-count clr9 flexC"},[e._v(e._s(e.charCount))]):e._e()]},proxy:!0},e.isComposerDisabled?null:{key:"icons",fn:function(){return[s("div",{staticClass:"clr9 flexC"},[e.value?e._e():[e.hasFileUpload&!e.isMobileDevice?s("Attachments",{ref:"attachment",staticClass:"mL5",attrs:{onShareHandler:e.handleAttachments,"data-zsqa":"conv_attachment"}}):e._e(),e.showEmoji?s("UnicodeEmojis",{directives:[{name:"click-out",rawName:"v-click-out",value:function(){return e.toggleEmoji(!1)},expression:"() => toggleEmoji(false)"}],staticClass:"siqcw-emoji-cont",attrs:{onSelect:e.handleEmojiSelection}}):e._e()],e.hasVoiceNote?s("Icon",{directives:[{name:"aria",rawName:"v-aria:button",value:{label:"siq.mic",disabled:!!e.ongoingCallDetail.chid},expression:"{label: 'siq.mic', disabled: !!ongoingCallDetail.chid}",arg:"button"},{name:"a11y",rawName:"v-a11y:box",arg:"box"}],staticClass:"siqico-microphone",class:[{"disbl-btn":e.ongoingCallDetail.chid},e.isMobileDevice?"mL5":"hover-type1"],attrs:{clickHandler:e.toggleVoiceRecorder,title:e.$doI18N("av.sendvoicenote"),direction:"left","data-zsqa":"mic_section"}}):e._e(),e.value?s("Icon",{staticClass:"siqico-send sel hover-type2 mL5 ifont20",attrs:{clickHandler:e.sendMessage,a11yArg:"box",ariaValue:{label:"siq.send"},"data-zsqa":"message_send_btn"}}):e._e()],2)]},proxy:!0}],null,!0)},"TextAreaComponent",e.textAreaProps,!1))],1):e._e()},[],!1,null,"c04dbc02",null)),N=B.exports,L=s("73c7"),$={name:"ConversationActions",props:{onAction:{type:Function,required:!0},chatId:{type:String,default:""}},data:()=>({isMobileDevice:o.c}),components:{ConversationMoreOptions:L.a}},A=(s("7d70"),Object(f.a)($,function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.isMobileDevice?e._e():s("div",{staticClass:"siqcw-conv-actions flexC posrel",class:[e.$scopedSlots.default?"justifySB":"justifyE"],attrs:{"data-zsqa":"conv_actions"}},[e._t("default"),s("div",{staticClass:"clr8 flexC conv-act-div"},[s("ConversationMoreOptions",{attrs:{onAction:e.onAction,chatId:e.chatId}}),s("Icon",{staticClass:"siqico-end mL5 ifont15 clr8",attrs:{clickHandler:function(){return e.onAction("close")},title:"chat.end",direction:"left",a11yArg:"box",ariaValue:{label:"chat.end"},"data-zsqa":"endchat"}})],1)],2)},[],!1,null,null,null)),R=A.exports,P={name:"ConversationTypingStatus",props:{attenderName:{type:String,default:""},wrapperClass:{type:String,default:""}}},V=Object(f.a)(P,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"clr9 italic font13 flexC ovrflw-hid w70"},[s("span",{directives:[{name:"title",rawName:"v-title:isElips",value:e.attenderName,expression:"attenderName",arg:"isElips"}],staticClass:"elips"},[e._v(e._s(e.attenderName))]),s("span",{staticClass:"fshrink mL5"},[e._v(e._s(e._f("i18n")("siq.typing","")))])])},[],!1,null,null,null),H=V.exports,W={name:"FeedbackFooter",props:{restartChat:Function,activeChatStatus:{type:Boolean,default:!0},isEngaged:{type:Boolean,default:!1}},data:()=>({isrestartLoading:!1}),inject:["embedDetail"],computed:{...Object(i.b)({allowNewChat:"conversationstore/allowNewChat",callOnlyEnabled:"embedstore/callOnlyEnabled"}),hasNewChat(){return this.allowNewChat&&!this.callOnlyEnabled}},methods:{reopenChat(){this.embedDetail.hasReopenChat||(this.isrestartLoading=!0),this.restartChat()}}},z=(s("b040"),Object(f.a)(W,function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.hasNewChat?s("div",{staticClass:"flexM fdirection clr7 siqcw-feedback-footer",attrs:{"data-zsqa":"feedback_footer_section"}},[e.hasNewChat?s("span",[s("div",{staticClass:"posrel iflexC"},[e.isrestartLoading?s("LoadingIcon",{staticClass:"posabs l0 r0 mgA",attrs:{className:"ifont14"}}):e._e(),s("div",[e.activeChatStatus||e.embedDetail.hasReopenChat?e._e():s("span",[e._v(e._s(e._f("i18n")(e.isEngaged?"chat.engagedstatus":"chat.offlinestatus","")))]),s("a",{directives:[{name:"a11y",rawName:"v-a11y:link",arg:"link"},{name:"aria",rawName:"v-aria:link",arg:"link"}],staticClass:"theme-clr mL5 curP",class:{blur_5:e.isrestartLoading},attrs:{"data-zsqa":"restart_chat"},on:{click:e.restartChat}},[e._v(" "+e._s(e._f("i18n")(e.embedDetail.hasReopenChat?"siq.reopenchat":e.activeChatStatus?"siq.newchat":"msg.offline",""))+" ")])])],1)]):e._e()]):e._e()},[],!1,null,null,null)),U=z.exports,G=s("1e41"),Q={name:"ConversationFooter",mixins:[F.a,G.a],props:{chatId:{type:String,required:!0}},inject:["getComposerDetail","getSendEmailId","getReplyMsgId","onMsgReply","reopenChat","embedDetail","handleBroadcastChat","openConversationForm","hasHeaderOption"],computed:{...Object(i.d)("embedstore",["visitorInfo"]),replyMsgId(){return this.getReplyMsgId()},composerDetail(){return this.getComposerDetail()||{}},sendEmailId(){return this.getSendEmailId()},infoMsg(){return this.chatDetail.botWaitingInfo||this.chatDetail.botPendingInfo}},methods:{getComposerRef(){return this.$refs.composer},focusComposer(){var e;null===(e=this.getComposerRef())||void 0===e||e.setFocus()},clearComposer(){var e;null===(e=this.getComposerRef())||void 0===e||e.clearValue()},restartChat(){if(c.e?this.chatConfig.reopen_conversation.enabled:this.embedDetail.hasReopenChat)return this.reopenChat();let e=this.embedDetail.dynamicConf;this.visitorInfo.uvid||!e.isTriggerWithoutTrackingEnabled?Object(a.cb)().then(this.handleTriggerReopen):Object(a.wb)(()=>{e.hasBroadcastDisabledFlow?(Object(a.qb)(""),this.openConversationForm()):this.handleBroadcastChat(this.getReopenObj())})},handleTriggerReopen(e){let t=e.triggers,s=t&&JSON.parse(t.type);if([2,16].includes(s))return void Object(a.db)(t);let i=this.getReopenObj();this.handleBroadcastChat(i)},getReopenObj(){let e={attenderDp:this.attenderDp,attenderIcon:this.attenderIcon};return["attenderId","attenderName","attenderDesc","departmentId"].forEach(t=>{e[t]=this.chatDetail[t]}),e}},components:{ConversationComposer:N,ConversationActions:R,FeedbackFooter:U,ConversationQuotedMessage:b.a,ConversationTypingStatus:H}},X=Q,K=(s("5e17"),s("5767"),s("eaa8"),Object(f.a)(X,function(){var e=this,t=e.$createElement,s=e._self._c||t;return!e.isVirtualLive&&!e.isClientMissed||e.isOfflineChat?e.sendEmailId||e.isCall||e.isPreview||e.chatDetail.showRating?e._e():s("FeedbackFooter",{attrs:{"restart-chat":e.restartChat,activeChatStatus:e.deptDetail.status,isEngaged:e.isEngagedChat}}):s("div",{staticClass:"flex fdirection posrel siqcw-conv-footer"},[e.infoMsg?s("span",{staticClass:"clr9 italic font13 flexC ovrflw-hid mL10 posabs ",class:{"bot-info":e.chatDetail.isBotTrigger}},[s("span",{staticClass:"elips"},[e._v(e._s(e.infoMsg))])]):e._e(),e.isLiveChat?[e.hasHeaderOption?e.chatDetail.typing?s("ConversationTypingStatus",{staticClass:"mL10",attrs:{attenderName:e.attenderName}}):e._e():s("ConversationActions",{attrs:{onAction:e.handleAction,chatId:e.chatId}},[e.chatDetail.typing?s("ConversationTypingStatus",{attrs:{attenderName:e.attenderName}}):e._e()],1)]:e._e(),s("ui-transitions",{attrs:{enterToClass:"siq-fadein",leaveToClass:"siq-fadeout"}},[e.replyMsgId?s("ConversationQuotedMessage",{attrs:{messageId:e.replyMsgId,onClose:function(){return e.onMsgReply("")}}}):e._e()],1),e.composerDetail.error?s("div",{staticClass:"clrA textC w100 font14 error-info"},[e._v(" ("+e._s(e.composerDetail.error)+") ")]):e._e(),s("ConversationComposer",{ref:"composer",attrs:{chatId:e.chatId,composerDetail:e.composerDetail}})],2)},[],!1,null,"0a69087a",null)),J=K.exports,Y=s("1ce0"),Z=s("7362"),ee=s("6df6"),te=s("7787"),se=s("5bb4"),ie=s("6489"),ae={name:"ChatBodyScroller",props:{unreadCount:{type:Number,default:0},scrollToTop:{type:Boolean,required:!0},scrollHandler:{type:Function,default:()=>{}}},components:{Goto:se.a,UnreadBubbleCount:ie.a}},ne=(s("35b8"),Object(f.a)(ae,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Goto",{attrs:{scrollHandler:e.scrollHandler,scrollToTop:e.scrollToTop}},[s("Icon",{staticClass:"clr8",class:e.scrollToTop?"siqico-uarrow":"siqico-darrow"}),e.unreadCount?s("UnreadBubbleCount",{attrs:{count:e.unreadCount}}):e._e()],1)},[],!1,null,"808f9466",null)),oe=ne.exports,re=s("9c44"),le=s("fa7d"),ce=s("7456"),de=s("7f80"),he=s("baec"),me=s("b5f5"),ue={name:"ConversationInlineForm",mixins:[he.a],props:{isEdit:Boolean,question:{type:String,required:!0},chatId:{type:String,required:!0},showFormField:{type:Boolean,default:!1},onUpdate:Function},inject:["scrollToBottom","closeForm"],computed:{...Object(i.d)("embedstore",["visitorInfo","embedDetail"]),...Object(i.d)("conversationstore",["conversationList"]),chatDetail(){return this.conversationList[this.chatId]}},provide(){return{getPrevChatDetail:this.getPrevChatDetail}},methods:{handleSkip(){this.isEdit?this.close():this.submitForm(!0)},handleFormSubmit(){this.submitForm(!1)},formLoad(){!me.c&&this.scrollToBottom()},submitForm(e){let t=this.$refs.form;if(!e&&!t.hasValidFields())return;this.close();let s=this.visitorInfo,i={name:s.name,email:s.email,phone:s.phone,first_name:s.first_name,last_name:s.last_name,salutation:s.salutation};if(this.isEdit&&Object(h.a)(i,t.fieldValues))return;let n=t.fieldValues;if(this.embedDetail.dynamicConf.isFirstNameFlowEnabled?delete n.name:(delete n.first_name,delete n.last_name),Object(a.kb)(n.salutation)||(n.salutation="None"),this.isEdit)return this.onUpdate(n);let{isWidgetOnline:o,chatId:r,chatDetail:l}=this;!o&&this.closeForm(),(o?ce.d:ce.b)({question:this.question,department_id:t.departmentId,visitor:{...e?{}:n},subscribe:t.isSubscribed,form_response:o?t.getFormResponse(e):void 0,attender_id:l.isBotTrigger&&l.attenderId||this.getPrevChatDetail().attenderId},r);let c=e?this.$doI18N("chat.skip"):t.getFormMessage(e);c&&de.a.appendTempMessage(r,de.a.getTempTextMessageObj(Object(le.a)(),c,{form_message:!0},r))},getPrevChatDetail(){return this.chatDetail.prevChatDetail||{}},close(){this.$emit("close"),this.$removeBanner()}},components:{ConversationForm:m.a,Button:u.a}},pe=ue,ge=(s("88b4"),Object(f.a)(pe,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ConversationForm",{ref:"form",staticClass:"inline-form pL15",attrs:{inputType:"inline",isEdit:e.isEdit,question:e.question,initiateChat:e.handleFormSubmit,ignoreQuestion:!0},on:{close:e.close,submit:function(t){return e.submitForm(!1)},deptUpdate:e.handleDepartmentUpdate,formLoad:e.formLoad},scopedSlots:e._u([{key:"field",fn:function(t){var i=t.isSkippable;return[s("div",[s("Button",{attrs:{text:"siq.done",clickHandler:e.handleFormSubmit,className:"siqcw-btn w100"}}),e.isEdit||i?s("span",{directives:[{name:"a11y",rawName:"v-a11y:box",arg:"box"},{name:"aria",rawName:"v-aria:button",value:{label:"siq.skip"},expression:"{label: 'siq.skip'}",arg:"button"}],staticClass:"curP clr6 font14 mT5 dib-mid",attrs:{"data-zsqa":"skip_btn"},on:{click:e.handleSkip}},[e._v(" "+e._s(e._f("i18n")("siq.skip"))+" ")]):e._e()],1)]}}])})},[],!1,null,null,null)),fe=ge.exports,ve={name:"ConversationEndTimer",props:{time:{type:Number,required:!0}},inject:["scrollChatBody"],mounted(){this.scrollChatBody()}},Ce=(s("8323"),Object(f.a)(ve,function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"textC clr9",domProps:{innerHTML:e._s(e.$doI18N("chatend.timer",e.time))}})},[],!1,null,"09041076",null)),be=Ce.exports,ye=s("1318"),_e=s("7e13"),De=s("4b5f"),we={name:"ChatTranslationConsent",props:{lang:{type:String,required:!0},chatId:{type:String,required:!0},attenderId:{type:String,required:!0},status:{type:String,required:!0}},data(){return{gtPolicyUrl:"",isNotify:"1"===this.status}},inject:["embedDetail","scrollChatBody"],beforeMount(){var e;let{embedDetail:t}=this;this.gtPolicyUrl=(null===(e=t.gtPolicyConfig)||void 0===e?void 0:e.url)||t.gtPolicyUrl},mounted(){this.scrollChatBody()},methods:{sendTransConsent(e){this.deleteTransConsent(),this.$store.dispatch("conversationstore/sendTransConsent",{chatId:this.chatId,accepted:e,lang:this.lang})},deleteTransConsent(){this.$store.commit("conversationstore/setTransConsent",{chatId:this.chatId})}},components:{Anchor:ye.a,Button:u.a,ProfilePic:_e.a,ImageFile:De.a}},Ie=we,Me=(s("7433"),Object(f.a)(Ie,function(){var e=this;e.$createElement;return e._self._c,e._m(0)},[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"textC gtrans-constent"},[s("div",{staticClass:"font14 clr7"},[e._v(" "+e._s(e._f("i18n")("gdpr.transinfo"))+" "),e.isNotify?s("div",{staticClass:"theme-clr mTB5"},[e._v(" "+e._s(e._f("i18n")("siq.gt"))+" "),s("span",{staticClass:"gt-bg-image"})]):e._e(),s("Anchor",{attrs:{url:e.gtPolicyUrl,value:e.$doI18N("siq.learnmore"),"data-zsqa":"gtpolicyurl"}})],1),s("div",{staticClass:"mT10",class:{flexM:e.isNotify}},[e.isNotify?s("Button",{attrs:{text:"Okay",clickHandler:e.deleteTransConsent}}):[s("Button",{attrs:{text:"gdpr.decline",clickHandler:function(){return e.sendTransConsent()},className:"siqcw-btn-cancel"}}),s("Button",{attrs:{text:"gdpr.accept",clickHandler:function(){return e.sendTransConsent(!0)},className:"siqcw-btn mL15"}})]],2)])}],!1,null,null,null)),Te=Me.exports,Se=s("7075"),ke={name:"CreditCardMaskingConsent",props:{handleConsent:{type:Function,required:!0}},inject:["scrollToBottom","embedDetail"],computed:{consentMsg(){return!c.e&&this.embedDetail.ccMasking.consentContent||this.$doI18N("card.mask")}},mounted(){this.scrollToBottom()},components:{ConversationConsent:Se.a}},Fe=Object(f.a)(ke,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ConversationConsent",{attrs:{"data-zsqa":"credit_card_section"},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" "+e._s(e.consentMsg)+" ")]},proxy:!0},{key:"cta",fn:function(){return[s("span",{directives:[{name:"a11y",rawName:"v-a11y:link",arg:"link"},{name:"aria",rawName:"v-aria:link",value:{label:"siq.yes"},expression:"{label: 'siq.yes'}",arg:"link"}],staticClass:"clrB curP",attrs:{"data-zsqa":"yes_btn"},on:{click:function(t){return e.handleConsent(!0)}}},[e._v(e._s(e._f("i18n")("siq.yes")))]),s("span",{directives:[{name:"a11y",rawName:"v-a11y:link",arg:"link"},{name:"aria",rawName:"v-aria:link",value:{label:"siq.no"},expression:"{label: 'siq.no'}",arg:"link"}],staticClass:"mL5 curP clr8",attrs:{"data-zsqa":"no_btn"},on:{click:function(t){return e.handleConsent(!1)}}},[e._v(e._s(e._f("i18n")("siq.no")))])]},proxy:!0}])})},[],!1,null,null,null),je=Fe.exports,Ee={name:"ChatQueueConsent",props:{chatId:{type:String,required:!0}},inject:["focusComposer"],methods:{missChat(){this.$store.dispatch("conversationstore/missChat",this.chatId).then(this.focusComposer)}},components:{ConversationConsent:Se.a}},qe=Object(f.a)(Ee,function(){var e=this,t=e.$createElement;return(e._self._c||t)("ConversationConsent",{attrs:{title:e.$doI18N("chat.wait"),consentCta:e.$doI18N("chat.leavemsg"),onCtaClick:e.missChat,"data-zsqa":"missed_chat_section"}})},[],!1,null,null,null),Oe=qe.exports,xe={name:"TypingLoader"},Be=(s("30a2"),Object(f.a)(xe,function(e,t){return t._c,t._m(0)},[function(e,t){var s=t._c;return s("div",{staticClass:"typing-loader pB10",attrs:{"data-zsqa":"bot_typing"}},[s("span"),s("span"),s("span")])}],!0,null,null,null)),Ne=Be.exports,Le={name:"BotTypingContainer",props:{sender:{type:Object,default:()=>({})}},components:{ConversationMessageAgentGroup:ee.a,TypingLoader:Ne}},$e=Object(f.a)(Le,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ConversationMessageAgentGroup",{attrs:{sender:e.sender,messageIds:[]}},[[s("div",{staticClass:"chat-bubble-cont single_msg"},[s("div",{staticClass:"chat-bubble"},[s("TypingLoader")],1)])]],2)},[],!1,null,null,null),Ae=$e.exports,Re=s("e335"),Pe=s("7c5e"),Ve={name:"ConversationResponseStream",props:{sender:{type:Object,default:()=>({})},streamMsgList:{type:Object,required:!0},scrollMsg:Function,attender:String},data:()=>({response:"",content:"",waitingList:[],chatBodyRect:null}),inject:["getChatBodyEl","scrollChatBody","scrollToBottom"],computed:{formattedContent(){return Object(Re.a)(Object(Pe.a)(this.content))}},mounted(){this.init()},watch:{streamMsgList:{immediate:!0,deep:!0,handler(e){this.response=this.getOrderedResponse(e.data)}},response:{immediate:!0,handler(e,t){e&&(e=e.replace(t,""),this.streamNewContent(e))}},attender(){this.streamMsgList.resolve&&this.streamMsgList.resolve()}},methods:{init(){let e=this.chatBodyEl=this.getChatBodyEl();this.chatBodyRect=e.getBoundingClientRect(),e.addEventListener("wheel",this.handleUserScroll),e.addEventListener("touchmove",this.handleUserScroll)},getOrderedResponse:e=>e.slice().sort((e,t)=>e.index-t.index).reduce((e,t,s)=>t.index!==s?e:e+t.msg,""),async streamNewContent(e){let t=e.split(" ");if(this.waitingList.length)return this.waitingList.push(...t);this.waitingList=t;for(let e=0;e<this.waitingList.length;e++)this.waitingList[e].trim()&&await this.appendNewContent(this.waitingList[e]+" ");this.checkAndResolve()},appendNewContent(e){return new Promise(t=>{setTimeout(()=>{this.content+=e,this.checkAndScroll(),t()},75)})},handleUserScroll(){this.isUserScrolled=!0,this.destroyWheelListener()},destroyWheelListener(){this.chatBodyEl.removeEventListener("wheel",this.handleUserScroll),this.chatBodyEl.removeEventListener("touchmove",this.handleUserScroll)},checkAndScroll(){if(this.isUserScrolled)return;let e=this.$el.getBoundingClientRect(),{top:t}=this.chatBodyRect;if(e.top>t+50)return this.scrollMsg();this.scrollChatBody(this.chatBodyEl.scrollTop+e.top-t)},checkAndResolve(){this.waitingList=[],this.streamMsgList.resolve&&(this.streamMsgList.resolve(),this.scrollToBottom())}},beforeDestroy(){this.checkAndResolve(),this.destroyWheelListener()},components:{ConversationMessageAgentGroup:ee.a,TypingLoader:Ne}},He=Ve,We=(s("0e46"),Object(f.a)(He,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ConversationMessageAgentGroup",{attrs:{sender:e.sender,messageIds:[]}},[[s("div",{staticClass:"chat-bubble-cont single_msg"},[s("div",{staticClass:"chat-bubble"},[s("span",{directives:[{name:"shtml",rawName:"v-shtml",value:e.formattedContent,expression:"formattedContent"}],staticClass:"type-writer"})])])]],2)},[],!1,null,"52ef5ab5",null)),ze=We.exports,Ue={name:"EmailConsent",props:["onClose","emailId","chatId"],data:()=>({isSending:!1}),inject:["dispatchAction"],methods:{sendEmail(){this.isSending=!0;let e="mail.success";Object(l.d)("visitorEmailTranscriptMail",this.emailId),this.dispatchAction("sendTranscriptMail",{email:this.emailId}).then(()=>{this.showMailStatusBanner(e)}).catch(t=>{this.showMailStatusBanner(1023===t.error.code?e:"mailsend.failed")}).finally(this.onClose)},showMailStatusBanner(e){this.$showBanner(this.$doI18N(e)),this.onClose()}},components:{Button:u.a}},Ge=Ue,Qe=Object(f.a)(Ge,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"close",rawName:"v-close",value:e.onClose,expression:"onClose"}],staticClass:"textC p10 clr3",attrs:{"data-zsqa":"email_consent"}},[e._v(" "+e._s(e._f("i18n")("chat.mail.trans",""))+" "),s("div",{staticClass:"theme-blue-clr mT5"},[e._v(e._s(e.emailId)+"?")]),s("div",{staticClass:"flexM mT10"},[s("Button",{attrs:{text:"siq.yes",clickHandler:e.sendEmail,loading:e.isSending,className:"siqcw-btn"}}),s("Button",{attrs:{text:"siq.no",clickHandler:e.onClose,className:"siqcw-btn-cancel mL15"}})],1)])},[],!1,null,null,null),Xe=Qe.exports,Ke={name:"GdprConsentBannerContent",props:{url:{type:String,default:""},textBannerObj:{type:Object,default:()=>({})}},data(){let e=this.$doI18N;return{consent1:e("siqcw.chatconsent1"),consent2:e("siqcw.chatconsent2"),consent3:e("siqcw.chatconsent3"),href:this.url}},beforeMount(){this.setJsapiConsent()},methods:{setJsapiConsent(){let e=this.textBannerObj,t=e.description;if(t){let s=e.policytextandlink||{},i=s.text,a=t.split(i);this.consent1=a.shift(),this.consent2=-1!==t.indexOf(i)?i:"",this.consent3=a.join(i)||"",this.href=s.link||""}}},components:{Anchor:ye.a}},Je=Ke,Ye=Object(f.a)(Je,function(){var e=this;e.$createElement;return e._self._c,e._m(0)},[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"textC"},[e._v(" "+e._s(e.consent1)+" "),s("Anchor",{attrs:{url:e.href,value:e.consent2}}),e._v(" "+e._s(e.consent3)+" ")],1)}],!1,null,null,null),Ze=Ye.exports,et={name:"ChatGDPRTerms",props:{chatDetail:{type:Object,required:!0}},data:()=>({showTerms:!0,termsUrl:(e=>c.e?e.privacy.privacy_policy.link:e.chatTerms.url)(Object(a.B)()),textBannerObj:{}}),inject:["focusComposer","scrollToBottom","handleBack"],beforeMount(){var e;this.textBannerObj=(null===(e=this.visitorInfo.textbannerobj)||void 0===e?void 0:e.online)||{}},mounted(){this.scrollToBottom()},computed:{...Object(i.d)("embedstore",["visitorInfo"]),...Object(i.b)("embedstore",["getDepartmentDetail","embedStatus","viewConversations"]),btnProps(){return[{text:this.textBannerObj.declinebutton||"gdpr.decline",className:"gdpr-btn siqcw-btn-cancel clr3",clickHandler:this.declineTerms},{text:this.textBannerObj.acceptbutton||"gdpr.accept",className:"gdpr-btn siqcw-btn clrW mL10",clickHandler:this.acceptTerms}]}},methods:{acceptTerms(){let{chatDetail:e}=this;e.showTerms=!1,((()=>{let t=e.initiationPayload.department_id;return this.embedStatus&&(!t||this.getDepartmentDetail(t).status)})()?ce.d:ce.b)(e.initiationPayload,e.id,!0),Object(a.xb)(),this.focusComposer(),this.updateCustomEvent(!0)},declineTerms(){this.showTerms=!1;let{chatDetail:e}=this;if(Object(a.b)(e))return this.cleanPreChatTranscript(e);Object(a.qb)(""),Object(a.k)(e.id),this.handleBack(),this.updateCustomEvent(!1)},updateCustomEvent(e){w.a.sendPostMessage("updateCustomEvent",{module:"chat_consent",value:e})},cleanPreChatTranscript(e){this.$minimize(),["chatFormValues","convform","showTerms"].forEach(t=>this.$delete(e,t)),this.$store.commit("conversationstore/cleanUserTranscript",e.id)}},components:{ButtonComponent:u.a,ChatGDPRTermsContent:Ze}},tt=et,st=(s("6be8"),s("73bc"),Object(f.a)(tt,function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.showTerms?s("div",{staticClass:"gdpr-cnsnt clr6"},[s("ChatGDPRTermsContent",{attrs:{url:e.termsUrl,textBannerObj:e.textBannerObj}}),s("div",{staticClass:"flexM mT10"},e._l(e.btnProps,function(e,t){return s("ButtonComponent",{key:t+"consent-btn",attrs:{text:e.text,className:e.className,clickHandler:e.clickHandler}})}),1)],1):e._e()},[],!1,null,"5c5ae07f",null)),it=st.exports,at=s("1436"),nt=s("2c40"),ot={data:()=>({transcriptGroup:[],msgLazyLoading:"",isTranscriptLoading:!1,unReadMsgIdInfo:{}}),inject:["dispatchAction","handleConversationFormResponse"],watch:{"transcriptDetail.ids":{immediate:!0,handler:"handleTranscriptUpdate"},chatId:{immediate:!0,handler:"init"},"transcriptDetail.unread.length":{immediate:!0,handler:function(e){if(Object(a.jb)()&&!this.isBotChat){if(e)return void(this.unReadMsgIdInfo={firstUnreadMsgId:this.transcriptDetail.unread[0],showUnreadColor:this.isLiveChat});this.clearUnreadBgColor()}}},isClosedChat(e){e&&this.clearUnreadBgColor()}},methods:{checkIsTransciptLoadable(){var e;let{chatDetail:t}=this;return t.id&&!(Object(a.g)(this.chatStatus)&&!t.isProactive||null!==(e=this.transcriptDetail)&&void 0!==e&&e.loaded)},init(){this.$nextTick(()=>{this.checkIsTransciptLoadable()?this.fetchTranscript():this.checkAndScrolltoBottom()})},fetchFormTranscript(){return this.$store.dispatch("embedstore/getVisitorConfiguration",{isTranscriptFetch:!0}).then(this.appendFormTranscript)},fetchTranscript(){return this.isTranscriptLoading=!0,(this.chatDetail.convform?this.fetchFormTranscript():this.fetchChatTranscript()).finally(()=>{this.isTranscriptLoading=!1,this.checkAndScrolltoBottom()})},fetchChatTranscript(){let{isProactive:e}=this.chatDetail;return this.dispatchAction(e?"getVisitorTranscript":"getTranscriptList",{params:{from:this.isVirtualLive||e?"bottom":"top",chat_id:e&&this.chId},reset:!0})},appendFormTempMessage(e){_.a.appendTempMessage(this.chatId,_.a.getTempTextMessageObj(Object(le.a)(),e,{},this.chatId))},appendFormTranscript(e){e&&e.msglist&&(this.appendFormTempMessage(e.visitor_question),this.chatDetail.attenderName=e.dname,e.msglist.forEach(e=>{e.sender?this.appendFormTempMessage(e.msg):this.handleConversationFormResponse(e)}))},checkAndLoadTranscript(e){let{transcriptDetail:t}=this;if(this.msgLazyLoading||!t.hasMore||(this.isLiveChat?e:!e))return;this.msgLazyLoading=e?"bottom":"top";let s=this.getScrollEl(),i=s.scrollHeight,a=s.offsetHeight;this.dispatchAction("getTranscriptList",{params:{[e?"from_time":"to_time"]:this.getLastMessageTime(e)}}).finally(()=>{this.msgLazyLoading="",this.$nextTick(()=>{s.scrollTop=e?i-a:s.scrollHeight-i})})},getLastMessageTime(e){let{ids:t}=this.transcriptDetail,s=Object(nt.c)(this.chatId,e?t[t.length-1]:t[0]),{last_message_time:i}=s;return i&&-1!=i?i:s.time},checkAndScrolltoBottom(){if(this.isVirtualLive&&!me.c){let{firstUnreadMsgId:e}=this.unReadMsgIdInfo;e&&document.getElementById(e)?this.scrollToMessage(e):this.forceScrollToBottom()}},handleTranscriptUpdate(e){e&&(this.resetTranscriptGroup(),this.updateTranscriptGroup(e,this.transcriptGroup),this.checkAndClearUnreadId())},checkAndClearUnreadId(){let e=this.transcriptGroup[this.transcriptGroup.length-1];e&&e.sender&&Object(a.i)(e.sender.id)&&(this.unReadMsgIdInfo.firstUnreadMsgId="")},updateTranscriptGroup(e,t,s){s=s||{sender:{}},e.forEach(e=>{let i=this.transcriptDetail.list[e];if(!i)return;let o=Object(a.h)(i),r=(()=>o||i.meta&&["content_moderation_close","content_moderation_warning","content_moderation_block"].includes(i.meta.meta_type)?{id:Object(le.a)(),name:o?i.message.dname:this.$doI18N("abusive.msg.sender")}:i.sender)(),l=!o&&i.type===n.r.info;l||s.isInfo||s.sender.id!==r.id?(s={sender:r,list:[e],isInfo:l,component:l?"ConversationInfoMessage":Object(a.i)(r.id)?"ConversationMessageVisitorGroup":"ConversationMessageAgentGroup"},t.push(s),s=l?{sender:{}}:s):s.list=[...s.list,e]})},resetTranscriptGroup(){this.transcriptGroup=[]},clearUnreadBgColor(){this.unReadMsgIdInfo&&(this.unReadMsgIdInfo.showUnreadColor=!1)}}},rt=(()=>{const e="bottom";return{data:()=>({scrollPosition:"",showScroller:!1,scrollDiff:0}),provide(){return{scrollToNewMsg:this.scrollToNewMsg,scrollToBottom:this.scrollToBottom,scrollChatBody:this.scrollChatBody,getChatBodyEl:()=>this.getScrollEl()}},beforeMount(){this.$eventBus.$on("scrollToNewMsg",this.scrollToNewMsg),this.$eventBus.$on("scrollToBottom",this.scrollToBottom),this.handleScroll=this.$debounce(this.handleScroll,50)},watch:{unreadMsgCount(){this.$nextTick(this.checkAndShowScroller)}},methods:{checkAndShowScroller(){let e=this.getScrollEl();if(!e)return!1;this.setScrollDiff(e);let{scrollDiff:t}=this,{scrollHeight:s,offsetHeight:i}=e;this.showScroller=s-i>100&&(this.isVirtualLive?s>i&&t<95:t>5)},getScrollEl(){let{scrollBar:e}=this.$refs;return e&&e.getScrollContainer()},scrollToBottom(e,t){(window._isFocussed||this.embedDetail.dynamicConf.allowBottomScroll)&&this.forceScrollToBottom(e,t)},getLastMessageGroupId(){let e=this.transcriptList[this.chatId];if(!e)return"";let t=[...e.ids].reverse(),s=this.lastMessage,i=s&&s.id,a=i;for(let e of t)if(e!==i){let t=this.getMessageDetail(this.chatId,e).last_message_time;if(!s||!t||s.last_message_time!==t)return a||"";a=e}return a||""},forceScrollToBottom(t,s){this.$nextTick(()=>{let i=s?"":this.getLastMessageGroupId(),a=i&&document.getElementById(i);if(a&&a.clientHeight>this.getScrollEl().clientHeight&&!c.t){let e=a.previousElementSibling;if(!e)return;let t=e=>{e.scrollIntoView({block:"start",behavior:"auto"})};e.classList.contains("siqcw-name-cont")?t(e):t(a)}else{let s=this.getScrollEl();if(!s)return;this.scrollChatBody(s.scrollHeight-s.offsetHeight,t),this.scrollPosition=e}})},scrollToElement(e){let t=this.getScrollEl(),{top:s}=t.getBoundingClientRect(),{top:i}=e.getBoundingClientRect();this.scrollChatBody(t.scrollTop+i-s-t.offsetHeight/2,!0)},scrollChatBody(e,t){this.getScrollEl().scrollTo({top:e,left:0,behavior:t?"smooth":"auto"})},scrollToMessage(e){const t="msg_blink";let s=document.getElementById(e);s?(this.scrollToElement(s),s.classList.add(t),s.onanimationend=function(){s.classList.remove(t),s.onanimationend=void 0}):this.$showBanner("chat.msg.notfound")},setScrollDiff(e){this.scrollDiff=e.scrollTop/(e.scrollHeight-e.offsetHeight)*100},handleScroll(){let t=this.getScrollEl();if(!t||t.scrollHeight===t.offsetHeight)return;this.checkAndShowScroller();let s=this.scrollDiff,i=this.scrollPosition=s>95?e:s>5?"top":"",{firstUnreadMsgId:a,showUnreadColor:n}=this.unReadMsgIdInfo;i!==e||(!a||n)&&a||this.updateReadReceipt(),("top"===this.transcriptDetail.loadedFrom?s>95:s<5)&&this.checkAndLoadTranscript(i===e)},scrollToNewMsg(t){c.t?(window._isFocussed=!0,this.scrollToBottom(!0)):this.isLiveChat&&(!t||t===this.chatId)&&this.scrollPosition===e&&this.scrollToBottom()},handleScrollerClick(){this.isVirtualLive?this.scrollToBottom(!0,!0):this.scrollChatBody(0,!0)}},beforeDestroy(){this.$eventBus.$off("scrollToNewMsg",this.scrollToNewMsg),this.$eventBus.$off("scrollToBottom",this.scrollToBottom)}}})(),lt=s("09b0"),ct=s("561f"),dt={beforeMount(){this.$eventBus.$on("visitorInfoEdit",this.openVisitorEdit)},beforeDestroy(){this.$eventBus.$off("visitorInfoEdit")},provide(){return{editVisitorDetail:this.openVisitorEdit}},inject:["embedDetail","openVisitorEditForm","dispatchAction","onMsgReply","formType"],methods:{openVisitorEdit(){if(this.formType===n.n.traditional)return this.openVisitorEditForm();this.$set(this.chatDetail,"visitorEdit",!0),this.onMsgReply("")},closeInlineForm(){this.chatDetail.visitorEdit=!1,this.chatDetail.inlineform=!1},handleChatStateChange(){this.isClosedChat&&this.closeInlineForm()}}};var ht={name:"ConversationMessageWindowBody",mixins:[ot,F.a,rt,dt,lt.a,ct.a],props:{chatId:{type:String,required:!0}},inject:["getCreditCardConsent","handleTranscriptEmail","getSendEmailId","getLastMessage"],provide(){return{checkIsLastMsg:e=>this.isVirtualLive&&this.lastMessage.id===e,checkIsFailedMsg:e=>{let{failedMsgIds:t}=this.transcriptDetail;return this.isLiveChat&&!!t&&t[0]===e}}},computed:{creditCardConsent(){return this.getCreditCardConsent()},sendEmailId(){return this.getSendEmailId()},lastMessage(){return this.getLastMessage()},showBotTypingName(){return!this.transcriptDetail.list||this.lastMessage.sender&&!this.lastMessage.sender.id.includes(this.attenderId)},showOprNameonEdit(){return Object(a.i)(this.getLastMessage().sender.id)}},components:{ConversationHandOff:()=>s.e("BotWidget").then(s.bind(null,"86f5")),ConversationMessageBodyWrap:Y.a,ChatTranslationConsent:Te,ConversationSenderName:at.a,ConversationMessageVisitorGroup:Z.a,ConversationMessageAgentGroup:ee.a,BotTypingContainer:Ae,ConversationInfoMessage:te.a,ConversationRating:re.a,ConversationInlineForm:fe,ConversationEndTimer:be,CreditCardMaskingConsent:je,ChatQueueConsent:Oe,ChatBodyScroller:oe,EmailConsent:Xe,ChatGDPRTerms:it,ConversationResponseStream:ze}},mt=ht,ut=(s("40e2"),Object(f.a)(mt,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ConversationMessageBodyWrap",[e.isTranscriptLoading?s("div",{staticClass:"flexM h100"},[s("LoadingIcon")],1):e.transcriptDetail.ids||e.chatDetail.typingId?s("ScrollContainer",{ref:"scrollBar",staticClass:"pT10",attrs:{onScroll:e.handleScroll,id:"scroll-container"}},["top"===e.msgLazyLoading?s("div",{staticClass:"flexM mTB10"},[s("LoadingIcon")],1):e._e(),e._l(e.transcriptGroup,function(t,i){return s(t.component,{key:t.sender.id+i,tag:"component",attrs:{messageIds:t.list,sender:t.sender,unReadMsgIdInfo:e.unReadMsgIdInfo}})}),e.isVirtualLive&&e.chatDetail.typingId&&!e.chatDetail.showTerms&&!e.chatDetail.streamMsgList?s("BotTypingContainer",{attrs:{sender:{id:e.attenderId,name:e.showBotTypingName&&e.attenderName||""}}}):e._e(),e.isVirtualLive&&e.chatDetail.streamMsgList?s("ConversationResponseStream",{attrs:{sender:{id:e.attenderId,name:e.attenderName||""},streamMsgList:e.chatDetail.streamMsgList,attender:e.chatDetail.attenderId,scrollMsg:function(){return e.scrollToNewMsg(e.chatId)}}}):e._e(),"bottom"===e.msgLazyLoading?s("div",{staticClass:"flexM mTB10"},[s("LoadingIcon")],1):e._e(),e.isClosedChat&&e.chatDetail.showRating?s("ConversationRating",{staticClass:"mB15",attrs:{chatDetail:e.chatDetail}}):e._e(),e.chatDetail.inlineform||e.chatDetail.visitorEdit?[e.chatDetail.visitorEdit&&e.showOprNameonEdit?s("ConversationSenderName",{staticClass:"mB10 pL15",attrs:{name:e.attenderName||""}}):e._e(),s("ConversationInlineForm",{staticClass:"pL15",attrs:{question:e.chatDetail.question,chatId:e.chatId,isEdit:e.chatDetail.visitorEdit,showFormField:e.chatDetail.inline,onUpdate:e.updateVisitorDetail},on:{close:e.closeInlineForm}})]:e._e(),e.chatDetail.endTimer?s("ConversationEndTimer",{attrs:{time:e.chatDetail.endTimer.secs}}):e._e(),e.isLiveChat&&e.chatDetail.transConsentConf?s("ChatTranslationConsent",e._b({attrs:{chatId:e.chatId,attenderId:e.attenderId,chId:e.chId}},"ChatTranslationConsent",e.chatDetail.transConsentConf,!1)):e._e(),e.creditCardConsent?s("CreditCardMaskingConsent",{attrs:{handleConsent:e.creditCardConsent}}):e._e(),e.isQueuedChat?s("ChatQueueConsent",{attrs:{chatId:e.chatId}}):e._e(),e.lastMessage.meta&&e.lastMessage.meta.hand_off&&e.isLiveChat&&!e.chatDetail.typingId&&e.isBotChat&&(!e.isOfflineTransfer||e.isDeptEngaged)&&!e.isBotBusy?s("ConversationHandOff",{attrs:{config:e.lastMessage.meta.handoff_config}}):e._e(),e.chatDetail.staticInfoMessage?s("ConversationInfoMessage",{staticClass:"theme-blue-clr curP",attrs:{staticInfoMessage:e.$doI18N("siq.drop.msg"),messageIds:[]},nativeOn:{click:function(t){return e.hideStaticMessage(t)}}}):e._e()],2):e._e(),e.showScroller&&e.isLiveChat?s("ChatBodyScroller",{attrs:{scrollToTop:!e.isVirtualLive,scrollHandler:e.handleScrollerClick,unreadCount:e.isLiveChat&&!e.isBotChat?e.unreadMsgCount:0}}):e._e(),e.sendEmailId?s("EmailConsent",{attrs:{chatId:e.chatId,emailId:e.sendEmailId,onClose:function(){return e.handleTranscriptEmail("")}}}):e._e(),e.chatDetail.showTerms?s("ChatGDPRTerms",{attrs:{"chat-detail":e.chatDetail}}):e._e()],1)},[],!1,null,null,null)),pt=ut.exports,gt=s("0f4d"),ft=s("769a"),vt=s("3066"),Ct=s("e9a5"),bt={name:"ConversationBanner",mixins:[F.a],props:{chatId:{type:String,required:!0}},data:()=>({showBanner:!0}),inject:["chatConfig"],computed:{...Object(i.d)("embedstore",["visitorInfo"]),...Object(i.b)("embedstore",["getDepartmentDetail","lang"]),statusBasedBannerMsg(){let{chatConfig:e,$doI18N:t}=this,s={waiting:e.waiting_message||t("msg.wait"),busy:e.agents_busy.message||t("msg.busymsg"),offlinecomplete:e.agents_offline.response||t("chat.offlineresp"),engagedcomplete:t("chat.offlineresp")};return e=>Object(a.M)(e)||s[e]},bannerMessage(){let e=this.isMissedChat?this.isEngagedChat?"engagedcomplete":this.isOfflineChat?"offlinecomplete":"busy":"waiting",t=this[c.e?"getV3BannerMsg":"statusBasedBannerMsg"](e);return t&&Object(vt.a)(t,this.chatId)},bannerClose(){return!this.showWaitingTimer},queuePositionMsg(){return this.$doI18N("chat.inqueue",this.$doI18N("chatqueue.queueno",this.chatDetail.queuePosition))}},methods:{getV3BannerMsg(e){let t={waiting:["waiting_message","msg.wait"],busy:["agent_busy_message","msg.busymsg"],offlinecomplete:["agent_offline_message","chat.offlineresp"],engagedcomplete:["agent_offline_message","chat.offlineresp"]},s=this.chatConfig.response_messages[t[e][0]];return s.enabled?s.message[this.lang]||this.$doI18N(t[e][1]):""},closeBanner(){this.showBanner=!1}},components:{Banner:Ct.a}},yt=bt,_t=(s("4352"),s("1687"),Object(f.a)(yt,function(){var e=this,t=e.$createElement,s=e._self._c||t;return(e.showWaitingTimer||e.isClientMissed)&&e.showBanner?s("Banner",{staticClass:"flex justifySB",attrs:{msg:e.bannerMessage,isHtml:!0,closeIcon:e.bannerClose,closeBtnClickHandler:e.closeBanner}},[e.showWaitingTimer?s("div",{staticClass:"flexC justifyE mL10 clr7 fshrink timer-cont",attrs:{"data-zsqa":"waiting_timer_section"}},[s("icon",{staticClass:"siqico-timer mR5 clr7 ifont18"}),s("span",{staticClass:"clr3"},[e._v(e._s(e.waitingTime))])],1):e._e()]):e.isQueuedChat&&e.chatDetail.queuePosition?s("Banner",{staticClass:"siq-queue-banner",attrs:{msg:e.queuePositionMsg}},[s("div",{staticClass:"font12 clr8-dark",attrs:{"data-zsqa":"waiting_queue"}},[e._v(" "+e._s(e._f("i18n")("msg.agent.connect",e.queueWaitingTime)))])]):e._e()},[],!1,null,"69bed439",null)),Dt=_t.exports,wt={name:"DropOverlay"},It=(s("76d0"),Object(f.a)(wt,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"drop-overlay-cont"},[s("icon",{staticClass:"siqico-upload ifont40 clr9"}),s("span",{staticClass:"font18 clr3"},[e._v(e._s(e._f("i18n")("file.drop")))]),s("p",{staticClass:"mT10 clr6 font16"},[e._v(e._s(e._f("i18n")("file.sizelimit","50 MB")))])],1)},[],!1,null,null,null)),Mt=It.exports,Tt=s("7942"),St=s("be50"),kt=s("a23c"),Ft=s("b6fc"),jt=s("c1a6"),Et=s("4f16"),qt={name:"CallHistory",mixins:[F.a],props:{chatId:{type:String,required:!0}},data:()=>({isLoading:!1,isAudioLoading:!1}),created(){let e=this.offlineVoiceNoteTranscriptEnabled&&this.missedCallWithAudio&&!this.mediaDetail.attachments;this.mediaDetail.id&&!e||(this.getMediaDetails(),this.setAudioMessageLoading())},computed:{connectedCallDuration(){return this.$doI18N("siq.oncall",this.mediaDuration)},callInfo(){return this.isMissedCall?this.$doI18N("call.deptmiss.info",this.chatDetail.departmentName):this.connectedCallDuration},connectedCallTimeInfo(){let e=this.mediaDetail.created_time||this.mediaDetail.connected_time;return`${Object(Tt.g)(e)}, ${Object(Tt.e)(e)}`},missedCallWithAudio(){return[this.mediaDetail.call_status,this.mediaDetail.status].includes(((Et.a||{}).status||{}).miss)&&"voice_message"===this.mediaDetail.attachment_type},fileObject(){let e=this.mediaDetail.attachments&&this.mediaDetail.attachments[0].message.file;if(e&&this.missedCallWithAudio)return e.durl=Object(a.F)(e,this.chatId),e.url=Object(a.E)(e,this.chatId),e},audioTranscript(){return this.offlineVoiceNoteTranscriptEnabled&&this.missedCallWithAudio&&!!this.fileObject},offlineVoiceNoteTranscriptEnabled:()=>Object(a.B)().dynamicConf.offlineVoiceNoteInTranscriptEnabled},watch:{mediaDetail:{immediate:!0,handler:"init"}},methods:{init(){this.handleAudioMessageLoadingState(),!this.mediaDetail.id&&this.getMediaDetails()},handleAudioMessageLoadingState(){!this.fileObject&&this.missedCallWithAudio||(this.isAudioLoading=!1)},setAudioMessageLoading(){this.offlineVoiceNoteTranscriptEnabled&&(this.isAudioLoading=!0)},getMediaDetails(){let{mediaDetail:e,chatDetail:t}=this,s=e.id||(e[0]?e[0].id:t.mediaData&&(t.mediaData||{}).media_id);!this.isLoading&&s&&(this.isLoading=!0,this.$store.dispatch("conversationstore/getMediaData",{chatId:this.chatId,mediaId:s}).finally(()=>{this.isLoading=!1}))},onDownload(){let{fileObject:e}=this;Object(jt.c)(e.durl,e.name)}},components:{AudioPlayer:St.a,SkeletonWrapper:kt.a,Skeleton:Ft.a}},Ot=qt,xt=(s("926f"),Object(f.a)(Ot,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h100 ovrflw-auto mT10 p10 clr3"},[e.isLoading?s("div",{staticClass:"flexM h100"},[s("LoadingIcon",{attrs:{className:"ifont20"}})],1):[s("div",{staticClass:"flexC"},[s("Icon",{class:["mR5",e.isMissedCall?"siqico-call-missed":"siqico-outgoing-call"]}),s("span",[e._v(e._s(e.callInfo))])],1),e.isMissedCall?e._e():s("div",{staticClass:"flexC"},[s("Icon",{staticClass:"siqico-faqdept clr8 mR5"}),s("span",[e._v(e._s(e.chatDetail.departmentName))])],1),s("div",{staticClass:"flexC"},[s("Icon",{staticClass:"siqico-calendar clr8 mR5"}),s("span",[e._v(e._s(e.connectedCallTimeInfo))])],1),e.isMissedCall?e._e():s("div",{staticClass:"clr7 flexM mT10"},[e._v(e._s(e._f("i18n")("call.endinfo")))]),e.isAudioLoading?s("div",{staticClass:"voice-msg-loader"},[s("skeleton-wrapper",{attrs:{className:"p20 flexC h_auto"}},[s("skeleton",{attrs:{type:"prof",size:"size-40 fshrink"}}),s("div",{staticClass:"mT20 mLR10 flexG"},[s("skeleton",{attrs:{size:"w75"}}),s("skeleton",{attrs:{size:"w100 h10 mT10"}}),s("div",{staticClass:"flexC mT15 justifySB"},[s("skeleton",{attrs:{size:"w40 h10"}}),s("skeleton",{attrs:{size:"w40 h10"}})],1)],1),s("skeleton",{attrs:{type:"prof",size:"size-40 fshrink"}})],1)],1):e.audioTranscript?s("div",{staticClass:"transcript-audio-bubble"},[s("audio-player",{attrs:{fileObject:e.fileObject,onDownload:e.onDownload}})],1):e._e(),s("div",{staticClass:"h-divider-div mT5"})]],2)},[],!1,null,"5e50dddf",null)),Bt=xt.exports;const Nt=()=>Promise.all([s.e("AttachmentPreview~CallBodyWrapper~ChatInitiator~ChatWindow~SelfService~TraditionalForm"),s.e("AttachmentPreview")]).then(s.bind(null,"9273"));var Lt={data:()=>({sendEmailId:"",creditCardConsent:void 0,replyMsgId:""}),beforeMount(){this.$eventBus.$on("conversationAction",this.handleConversationActions)},beforeDestroy(){this.$eventBus.$off("conversationAction")},provide(){return{getChatId:()=>this.chatId,getChatDetail:()=>this.chatDetail,dispatchAction:this.dispatchAction,checkIfSupportedOperation:e=>this.visitorDetail.supported_operations.includes(e),onMsgReply:this.handleMessageReply,getReplyMsgId:()=>this.replyMsgId,hasMsgActions:()=>this.isLiveOperatorChat&&(!!c.e||this.embedDetail.messageActionConfig),isMsgModificationAllowed:this.isMsgModificationAllowed,handleMsgDelete:this.handleMsgDelete,handleMsgEdit:this.handleMsgEdit,hasInfoMsgAction:()=>this.isLiveOperatorChat,handleChatEnd:this.handleChatEnd,getVisitorDetail:()=>this.visitorDetail,reopenChat:this.handleChatReopen,scrollChatBody:this.scrollChatBody,focusComposer:this.focusComposer,clearComposer:this.clearComposer,scrollToMsg:this.scrollToMessage,handleCreditCard:this.handleCreditCard,getCreditCardConsent:()=>this.creditCardConsent,handleTranscriptEmail:this.handleSendTranscript,getSendEmailId:()=>this.sendEmailId,openFilePreview:this.openFilePreview,getLastMessage:this.getLastMessage}},methods:{closeDialog(){this.dialogProps=void 0},handleMessageReply(e){this.replyMsgId=e,this.closeDialog(),e&&this.focusComposer()},getComposerRef(){let{footer:e}=this.$refs;return e&&e.getComposerRef()},focusComposer(){this.getComposerRef().setFocus()},clearComposer(){this.getComposerRef().clearValue()},handleFileDrop(e,t){this.$el.contains(t.target)&&this.getComposerRef().handleFileUpload(e)},scrollChatBody(e){this.$refs.chatBody.scrollToBottom(e)},scrollToMessage(e){this.$refs.chatBody.scrollToMessage(e)},handleCreditCard(e,t){this.creditCardConsent=e?t:void 0},handleSendTranscript(e){this.sendEmailId=e},isMsgModificationAllowed(e){let{chatDetail:t}=this,s=t.forwardTime;return e=parseInt(e),s?e>parseInt(s):e>parseInt(t.inTime)},handleMsgDelete(e){this.dialogProps={iconClass:"siqico-delico cir-delicn ifont18",popupClass:"p30",title:this.$doI18N("siq.delmsg"),desc:this.$doI18N("msg.deleted.info"),ctaButton:{text:this.$doI18N("siq.delete"),className:"siqcw-btn-delete",clickHandler:()=>{this.dispatchAction("deleteMessage",{chatId:this.chatId,msgId:e}),this.closeDialog()}}}},handleChatEnd(){this.dialogProps={iconClass:"siqico-end cir-delicn ifont18",popupClass:"p30",title:this.$doI18N("chat.end"),desc:this.$doI18N("chat.end.desc"),id:"chatEndBanner",ctaButton:{text:this.$doI18N("siqcw.end"),className:"siqcw-btn-delete",clickHandler:()=>{this.dialogProps&&(this.dialogProps.ctaButton.loading=!0),Object(a.j)(this.chatId)},loading:!1}}},closeChatEndDialog(){var e;"chatEndBanner"===(null===(e=this.dialogProps)||void 0===e?void 0:e.id)&&this.closeDialog()},handleMsgEdit(e,t,s){let i=t,r=(t,n)=>{l.disabled||null!=n&&n.shiftKey||Object(a.gb)(n)||(this.dispatchAction("editMessage",{chatId:this.chatId,msgId:e,data:{[s]:i}}),this.closeDialog())},l={text:this.$doI18N("siq.done"),className:"siqcw-btn",disabled:!0,clickHandler:r},c=Object(nt.c)(this.chatId,e);this.dialogProps={iconClass:"siqico-edit",title:this.$doI18N("siq.editmsg"),inputProps:{value:i,autoFocus:!0,needFocusAnim:!1,onInputChange:e=>{i=e,l.disabled=!i||i===t},onEnter:r,...c.type===n.r.file?{maxLength:n.b}:{hasEmoji:this.embedDetail.showEmoji&&!o.c}},ctaButton:l}},handleChatReopen(){let e="",t={};this.embedDetail.dynamicConf.isFirstNameFlowEnabled?(t.first_name=this.visitorDetail.first_name,t.last_name=this.visitorDetail.last_name):t.name=this.visitorDetail.name;let s=(s,n)=>{!e||i.disabled||this.reopening||Object(a.gb)(n)||(n&&n.preventDefault(),this.closeDialog(),this.reopening=!0,Object(ce.c)(e,this.chatDetail,t).finally(()=>{this.reopening=!1}),this.scrollChatBody())},i={text:this.$doI18N("siq.reopen"),className:"siqcw-btn",disabled:!0,clickHandler:s};this.dialogProps={title:this.$doI18N("chat.reopen"),inputProps:{value:"",autoFocus:!0,needFocusAnim:!1,placeHolder:this.$doI18N("compos.hint"),onInputChange:t=>{e=t,i.disabled=!t},onEnter:s},ctaButton:i}},openFilePreview(e){let t=[],{ids:s,list:i}=this.transcriptDetail;s.forEach(e=>{let s=i[e];s.deleted||s.type!==n.r.file||(!(s.message.file||{}).snippet&&((s.message.file||{}).snippet=s.snippet),t.push({...s.message,sender:s.sender}))}),this.$showDialog({files:t,selectedFile:e,chatId:this.chatId},Nt)},getLastMessage(){let{transcriptDetail:{list:e,ids:t}}=this;if(!e)return{};for(let s=t.length-1;s>=0;s--){let i=e[t[s]];if(this.chatDetail.forwardTime||i.type!==n.r.info)return i}return{}},handleConversationActions(e,t){let s={close:this.handleChatEnd,transcriptEmail:function(){this.handleSendTranscript(t)}.bind(this)};"function"==typeof s[e]&&s[e]()}},watch:{ongoingCallDetail:{immediate:!0,handler(e){e.chid===this.chatDetail.wmsId&&this.closeChatEndDialog()}}}},$t={data:()=>({showVisitorForm:!1,isVisitorDetailEdit:!1}),computed:{...Object(i.d)("embedstore",["formFieldConfig","embedDetail"]),...Object(i.b)("embedstore",["embedStatus","formType"])},provide(){return{handlePreChatForm:this.handlePreChatForm,openVisitorEditForm:this.openVisitorEditForm}},beforeMount(){this.getVisitorFields()},mounted(){let{prechatDetail:e}=this.chatDetail;e&&(this.handlePreChatForm(e.question,e.meta),delete this.chatDetail.prechatDetail)},methods:{getVisitorFields(){c.e||!this.isLiveChat&&!this.isWaitingChat||this.formFieldConfig.chat[this.embedDetail.embedStatus]||this.isFieldFetching||(this.isFieldFetching=!0,this.$store.dispatch("embedstore/getVisitorConfiguration"))},handlePreChatForm(e,t){let{chatDetail:s}=this;s.question=e,s.meta=t,{[n.n.traditional]:()=>this.toggleForm(!0),[n.n.inline]:this.handleInlinePrechat,[n.n.chat]:()=>this.handleConversationFormPreChat(s)}[this.formType]()},async handleInlinePrechat(){this.appendQuestionMessage(),this.clearComposer(),await store.dispatch("embedstore/getVisitorConfiguration",{question:this.chatDetail.question,clearContext:!0}),Object(nt.a)(this.chatId),this.$set(this.chatDetail,"inlineform",!0)},handleConversationFormPreChat(e){this.$set(e,"convform",!0),this.appendQuestionMessage(),this.checkAndStartChatForm(),this.clearComposer()},openVisitorEditForm(){this.toggleForm(!0),this.isVisitorDetailEdit=!0},closeVisitorForm(){this.toggleForm(!1),this.isVisitorDetailEdit=!1},toggleForm(e){this.showVisitorForm=null!=e?e:!this.showVisitorForm},handleFormSubmit(e){if(this.isVisitorDetailEdit)return this.updateVisitorDetail(e.visitor);this.appendQuestionMessage();let{chatDetail:t}=this;Object(ce.d)({...e,question:t.question,attender_id:t.isBotTrigger&&this.attenderId},this.chatId),this.closeVisitorForm(),this.clearComposer(),this.focusComposer()},appendQuestionMessage(){let{chatId:e}=this;_.a.appendTempMessage(e,_.a.getTempTextMessageObj(this.chatId,this.chatDetail.question,{},e))}}},At=s("56e1"),Rt=s("6661"),Pt={mixins:[he.a],inject:["closeForm"],computed:{...Object(i.d)("embedstore",["visitorInfo"]),...Object(i.b)("embedstore",["defaultChatDepartment","embedStatus"])},beforeMount(){this.checkAndStartChatForm()},provide(){return{skipFormField:this.skipFormField,getComposerDetail:()=>this.chatDetail.composerDetail,handleCampaignOption:this.handleCampaignOption,handleChatFormInput:this.handleChatFormInput,handleDeptSelection:this.handleDeptSelection,handleSalutationSelection:this.handleSalutationSelection,assignVisitorValues:this.assignVisitorValues,handleChatFormSend:this.handleChatFormSend,updateComposerDetail:this.updateComposerDetail,handleConversationFormResponse:this.handleConversationFormResponse}},methods:{checkAndStartChatForm(){this.chatDetail.convform&&!this.chatDetail.chatFormValues&&this.handleFormChat()},handleFormChat(){var e;let{visitorInfo:t,chatDetail:s}=this;s.chatFormValues={department_id:s.departmentId||(null===(e=s.prevChatDetail)||void 0===e?void 0:e.departmentId)||this.defaultChatDepartment,visitor:{name:Object(a.f)(t.name)?"":t.name,email:t.email,phone:t.phone,first_name:t.first_name,last_name:Object(a.f)(t.last_name)?"":t.last_name,salutation:t.salutation}},this.fetchFormDetails()},fetchFormDetails(){let e=Object(a.b)(this.chatDetail);this.dispatchVisitorConfiguration({question:this.chatDetail.question,clearContext:!e},t=>{if(e)return this.fetchFormFields(t);this.handleConversationFormResponse(t)})},fetchFormFields(e){Object(At.a)(this.chatDetail,e.msglist)?this.dispatchVisitorConfiguration({question:this.chatDetail.question,clearContext:!0},this.handleConversationFormResponse):this.initiateFormChat()},dispatchVisitorConfiguration(e,t){this.$store.dispatch("embedstore/getVisitorConfiguration",e).then(t)},initiateFormChat(){var e;let{isWidgetOnline:t,chatDetail:s}=this;s.composerDetail=void 0,!t&&this.closeForm(),(t?ce.d:ce.b)({question:s.question,attender_id:s.isBotTrigger&&this.attenderId||(null===(e=s.prevChatDetail)||void 0===e?void 0:e.attenderId),...s.chatFormValues},this.chatId)},handleConversationFormResponse(e){if("context_completed"===e||"object"==typeof e&&!Object.keys(e).length)return Object(Rt.b)(),this.initiateFormChat();e=e.msglist?e.msglist[0]:e;let{meta:t}=e,{chatDetail:s}=this;s.currentFormMeta=t;let i=Object(At.k)(t);if(this.isSkipField(t,i))return this.ignoreField(i&&s.chatFormValues.department_id);e.dname&&!Object(a.b)(s)&&(s.attenderName=e.dname),this.appendFormMessage(e,t,i),this.updateComposerDetail({placeHolder:i?this.$doI18N(n.l[n.j.dept]):this.getFormPlaceHolder(t),handleInput:!0,error:""}),this.scrollChatBody(),this.focusComposer(),this.$playTune(c.N.message)},updateComposerDetail(e){this.$set(this.chatDetail,"composerDetail",e)},checkIfNameValueExists:(e,t)=>e.every(e=>t[e.meta.field_name]),isSkipField(e,t){let{chatDetail:{chatFormValues:s}}=this;if(t&&s.department_id||!t&&w.a.isJWTEnabled())return!0;let i=Object(At.j)(e),a=Object(At.b)(e)||(i?n.j.campaign:"");if(!a)return!1;let{chatmode:o,chatstart:r,clearfield:l=[]}=this.visitorInfo,d="name"===a&&c.e?this.checkIfNameValueExists(e.fields,s.visitor):s.visitor[a],h=(o||r)&&(e.skippable||i),m=l.includes("siq_"+a);return!!(d||h||m)},appendFormMessage(e,t,s){let{chatId:i}=this,a=de.a.getTempTextMessageObj(Object(le.a)(),e.msg||this.getDefaultFormOprMsg(t,s),{},i);switch(a.sender=Object(nt.b)(),a.sender.name=e.dname||this.attenderName,a.isSkippable=t.skippable,!0){case Object(At.j)(t):a.campaignOption=this.getFormCampaignOptions(),a.isSkippable=!1;break;case s:a.departmentSelection=!0;break;case t.input_card.type===n.j.firstname:a.salutation=e.meta.input_card.salutation;break;case c.e&&"name"===t.field_name:a.nameField=e}de.a.appendTempMessage(i,a)},handleDeptSelection(e){this.chatDetail.chatFormValues.department_id=e.id,this.handleDepartmentUpdate(e.status),this.handleChatFormSend(e.name,{value:e.id}),this.focusComposer()},getFormCampaignOptions(){return[{id:"yes",title:this.$doI18N("siq.yes")},{id:"no",title:this.$doI18N("siq.no")}]},handleCampaignOption(e){this.handleChatFormSend(e.title),this.focusComposer()},getDefaultFormOprMsg(e,t){let s=this.$doI18N;return t?s("faq.dept"):e.input_card&&{[n.j.name]:s("name.ques"),[n.j.firstname]:s("common.fnameques"),[n.j.lastname]:s("common.lnameques"),[n.j.phone]:s("phone.ques"),[n.j.email]:s("mail.ques"),[n.j.campaign]:s("siqcw.campaignlabel")}[e.input_card.type]},getFormPlaceHolder(e){let t=e.input_card;return t&&(t.placeholder||n.l[t.type])},handleChatFormInput(e){let t=this.chatDetail,s=t.currentFormMeta,i=Object(At.l)(s,e);if(i.error)return this.chatDetail.composerDetail.error=i.message;let a,o={[n.j.name]:"name",[n.j.email]:"email",[n.j.phone]:"phone",[n.j.firstname]:"first_name",[n.j.lastname]:"last_name",[n.j.salutation]:"salutation"},r=o[s.input_card.type];this.assignVisitorValues(r,e),r===o[[n.j.firstname]]&&(a={salutation:t.visitor.salutation}),this.handleChatFormSend(e,a)},assignVisitorValues(e,t){let s=this.chatDetail;s.chatFormValues.visitor[e]=t,this.$set(s.visitor,e,t)},handleSalutationSelection(e){let t=this.chatDetail;t.chatFormValues.visitor.salutation===e?(delete t.chatFormValues.visitor.salutation,this.$delete(t.visitor,[n.j.salutation])):(t.chatFormValues.visitor.salutation=e,this.$set(t.visitor,[n.j.salutation],e)),this.focusComposer()},handleChatFormSend(e,t){this.sendFormMessage({text:e,meta:t})},ignoreField(e){this.dispatchFormMessage({ignore:!0,text:e||this.$doI18N("chat.skip")})},skipFormField(){let e=this.$doI18N("chat.skip"),t={type:"skip",value:"-"},s=this.chatDetail.chatFormValues.visitor.salutation;this.chatDetail.currentFormMeta.input_card.type===n.j.firstname&&s&&(t={salutation:s}),this.sendFormMessage({text:e,meta:t})},sendFormMessage(e){var t;let{chatId:s}=this,i=e.text,n=null===(t=e.meta)||void 0===t?void 0:t.salutation;n&&(i=Object(a.R)(n)+". "+i),!(this.chatDetail.currentFormMeta||{}).autoskip&&de.a.appendTempMessage(s,de.a.getTempTextMessageObj(Object(le.a)(),i,{},s)),this.scrollChatBody(),this.clearComposer(),this.dispatchFormMessage(e)},dispatchFormMessage(e){this.$store.dispatch("embedstore/sendFormMessage",e).then(e=>{if("string"!=typeof e&&c.e&&!(e=Object(At.i)([e],!0,this.embedStatus)).msglist.length)return this.ignoreField();this.handleConversationFormResponse(e)})}}},Vt=s("13f5"),Ht=s("daad"),Wt=s("2e35"),zt={data:()=>({showDrop:!1,dragTarget:""}),watch:{hasDragAndDrop:{immediate:!0,handler(e){this.unBindDragListeners(),!e&&(this.showDrop=!1),e&&this.bindDragListeners()}}},methods:{bindDragListeners(){let e=document.addEventListener;e("dragenter",this.handleDragEnter),e("dragover",this.handleDragOver),e("dragleave",this.handleDragLeave),e("drop",this.handleDrop)},handleDragEnter(e){e.preventDefault(),e.dataTransfer.types.includes("Files")&&(this.showDrop=!0,this.dragTarget=e.target)},handleDragOver(e){e.preventDefault();let t=this.$refs[this.dropLocationId];t&&t.contains(e.target)&&(e.dataTransfer.dropEffect="copy")},handleDragLeave(e){e.preventDefault(),e.target===this.dragTarget&&(this.showDrop=!1)},handleDrop(e){this.showDrop=!1,e.preventDefault();let t=e.dataTransfer.files;t.length&&this.handleFileDrop(t,e)},unBindDragListeners(){let e=document.removeEventListener;e("dragenter",this.handleDragEnter),e("dragover",this.handleDragOver),e("dragleave",this.handleDragLeave),e("drop",this.handleDrop)}},beforeDestroy(){this.hasDragAndDrop&&this.unBindDragListeners()}},Ut={name:"ConversationMessageWindow",mixins:[F.a,Lt,$t,Pt,Vt.a,Ht.a,zt,Wt.a],props:{chatId:{type:String,required:!0}},data(){return{dialogProps:void 0,showSendEmail:!1,sendMailIcon:{class:["siqico-smailico ifont22 header-send-mail",{"header-icon-div":o.c}],title:this.$doI18N("siq.mailtrans"),direction:"left-middle",clickHandler:()=>{if(this.embedDetail.dynamicConf.isMailTranscriptNewFlow){let e=this.visitorInfo.email||Object(l.b)("visitorEmailTranscriptMail");if(e)return void this.$eventBus.$emit("conversationAction","transcriptEmail",e)}this.showSendEmail=!0}},audioIcon:{class:["siqico-call siqcw-audio",{"header-icon-div":o.c}],title:this.$doI18N("siqcw.makecall"),direction:"left-middle",clickHandler:Object(a.hb)()?this.checkConsentAndInitCall:this.startAudioCall},consentWindow:"chat"}},computed:{...Object(i.d)("conversationstore",["chatsLoaded"]),...Object(i.d)("mediastore",["activeCall"]),...Object(i.d)("embedstore",["visitorInfo"]),...Object(i.b)("embedstore",["embedStatus","hasFileShare"]),headerDetails(){let e=[this.attenderName,this.attenderDp];return c.e&&"operator"!==Object(At.h)()||e.push(this.chatDetail.attenderDesc),e},hasDragAndDrop(){return this.isLiveChat&&!this.isBotChat&&this.hasFileShare}},inject:["patchCurrentNavigation","embedDetail"],created(){!this.chatDetail.id&&Object(a.qb)("")},beforeMount(){this.viewConversationList=this.embedDetail.viewConversations},watch:{headerDetails:{immediate:!0,deep:!0,handler:"updateHeaderDetails"},hasCallIcon:{immediate:!0,handler(e){this.patchCurrentNavigation({customIcon:e?this.audioIcon:void 0})}},isCompletedChat:{immediate:!0,handler(e){if(this.hasCallIcon)return;let t=this.embedDetail;this.patchCurrentNavigation({customIcon:!e||!t.sendEmail||this.sendEmailId||this.isCall||this.isPreview||t.dynamicConf.isMailTranscriptNewFlow&&!this.visitorInfo.email||!["Manual","Both"].includes(t.portalConfig.chatTranscript)?void 0:this.sendMailIcon})}}},methods:{handleChatStateChange(){this.getVisitorFields(),this.updateHeaderDetails(),this.isLiveChat||(this.closeVisitorForm(),this.closeDialog(),this.handleMessageReply(""));let{chatDetail:e}=this;e.typingId&&this.isClosedChat&&e.typingResolver&&e.typingResolver()},updateHeaderDetails(){let[,e,t]=this.headerDetails,s={title:this.getHeaderTitle()};this.chatDetail.isPreview||((this.embedStatus||this.chId||Object(a.b)(this.chatDetail))&&(s.imgSrc=e,s.iconClass=this.attenderIcon,s.desc=this.isWaitingChat?"":t),this.patchCurrentNavigation(s))},getHeaderTitle(){let{$doI18N:e,isCall:t}=this,s=Object(a.L)(this.embedStatus),i=c.e?Object(At.c)(this.attenderName):this.attenderName;switch(!0){case Object(a.b)(this.chatDetail):return i;case!this.embedStatus&&!this.chId:return s||e("msg.offline");case this.isEngagedChat:return e("msg.engaged");case this.isOfflineChat:return e(t?"audio.voicemsg":"chat.offlinetext");case this.isPendingChat:case this.isWaitingChat:case this.isQueuedChat:return e("chat.await");case this.chatStatus===n.g.temp:return s||e("siq.chatwithus");case!!i:return i;case this.isMissedChat:return e(t?"call.missed":"chat.missed")}},dispatchAction(e,t){return this.$store.dispatch("conversationstore/"+e,{chatId:this.chatId,...t||{}})},handleChatwindowClick(){this.$refs.chatBody.clearUnreadBgColor(),this.unreadMsgCount&&this.updateReadReceipt()}},beforeDestroy(){var e;(null===(e=this.activeCall)||void 0===e||!e.media_id)&&(this.viewConversationList||!this.isLiveChat)&&this.$store.state.activeTab!==r.a.chat&&Object(a.qb)(""),this.updateReadReceipt()},components:{ConversationMessageWindowWrap:d.a,ConversationVisitorForm:C,ConversationMessageWindowBody:pt,ConversationFooter:J,ConversationBanner:Dt,ConversationMessageWindowDialog:ft.default,DropOverlay:Mt,CallHistory:Bt,ConversationSendEmail:gt.a}},Gt=Ut,Qt=(s("4b9f"),s("71548"),Object(f.a)(Gt,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ConversationMessageWindowWrap",{attrs:{onClick:e.isLiveChat||e.chatDetail.isProactive?e.handleChatwindowClick:null}},[s("span",{staticClass:"seasonal-msg-bgimg"}),e.chatDetail.id?e._e():s("div",{staticClass:"flexM h100"},[s("LoadingIcon")],1),[e.showDrop?s("DropOverlay",{attrs:{"data-zsqa":"dropoverlay"}}):e._e(),e.showSendEmail?s("ConversationSendEmail",{staticClass:"header-email",attrs:{onClose:function(){return e.showSendEmail=!1}}}):e._e(),e.isCall?e._e():s("ConversationBanner",{attrs:{chatId:e.chatId}}),e.showVisitorForm?s("ConversationVisitorForm",{attrs:{onSubmit:e.handleFormSubmit,isEdit:e.isVisitorDetailEdit,onClose:e.closeVisitorForm}}):e._e(),e.isCall?s("CallHistory",{attrs:{chatId:e.chatId}}):s("ConversationMessageWindowBody",{ref:"chatBody",attrs:{chatId:e.chatId}}),e._v(" "),e.dialogProps||e.showCallConsent?s("ConversationMessageWindowDialog",e._b({attrs:{onClose:e.showCallConsent?e.consentProps.onClose:e.closeDialog}},"ConversationMessageWindowDialog",e.showCallConsent?e.consentProps:e.dialogProps,!1)):e._e(),e.isCall?e._e():s("ConversationFooter",{ref:"footer",attrs:{chatId:e.chatId}})]],2)},[],!1,null,"6c09af8f",null));t.default=Qt.exports},"4d9a":function(e,t,s){},"4ecc":function(e,t,s){"use strict";s("e307")},"50a8":function(e,t,s){"use strict";var i={name:"MessageBubbleContainer",props:{listeners:{type:Object,default:()=>({})}}},a=(s("7917"),s("2877")),n=Object(a.a)(i,function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",e._g({staticClass:"chat-bubble-cont single_msg"},e.listeners),[e._t("default")],2)},[],!1,null,null,null);t.a=n.exports},"50c2":function(e,t,s){},"50d5":function(e,t,s){},"53d7":function(e,t,s){},5463:function(e,t,s){},"561f":function(e,t,s){"use strict";s.d(t,"c",function(){return c}),s.d(t,"b",function(){return d});var i=s("2b0e"),a=s("b5f5");let n=function(e){var t;e+="...",a.b?a.f&&(null===(t=a.f.setBotWaitingInfo)||void 0===t||t.call(a.f,e)):i.a.set(this,"botWaitingInfo",e)},o=function(e){let t=e.info.length,s=e.time/t;this.waitingTimeout=setTimeout(function(){if(e.infoid===t)return this.removeBotWaitingCard(),void(this.botWaitingResolver&&this.botWaitingResolver());n.call(this,e.info[e.infoid]),e.infoid++,o.call(this,e)}.bind(this),s)},r=function(e){let{time:t}=e;t&&(n.call(this,e.info[Math.floor(Math.random()*e.info.length)]),this.waitingTimeout=setTimeout(()=>{this.removeBotWaitingCard(),this.botWaitingResolver&&this.botWaitingResolver()},t))},l=function(e){e.infoid=0,n.call(this,e.info[e.infoid]),e.infoid++,o.call(this,e)},c=function(e){this.removeBotWaitingCard(),this.removeBotTyping(),"random"===e.info_type?r.call(this,e):l.call(this,e)},d=function(){var e;clearTimeout(this.waitingTimeout),a.b?a.f&&(null===(e=a.f.setBotWaitingInfo)||void 0===e||e.call(a.f)):i.a.delete(this,"botWaitingInfo"),delete this.waitingTimeout};t.a={beforeMount(){this.initWaitingWatchers()},watch:{isBotChat(e,t){!t&&e&&this.initWaitingWatchers()}},methods:{handleBotWaitingCard(){let{chatDetail:e}=this;e.updateBotWaitingCard=c,e.removeBotWaitingCard=d},initWaitingWatchers(){if(!this.isBotChat||this.isClosedChat)return void d.call(this.chatDetail);let e="handleBotWaitingCard";this.$eventBus.$on(e,e=>{e.chatId===this.chatId&&this.handleBotWaitingCard()}),this.$once("hook:beforeDestroy",()=>{this.$eventBus.$off(e)})}}}},5767:function(e,t,s){"use strict";s("85c1")},"57b8":function(e,t,s){"use strict";s("9e1e8")},"5b49":function(e,t,s){"use strict";s("93da")},"5bb4":function(e,t,s){"use strict";var i={name:"Goto",props:{scrollHandler:{type:Function,required:!0},scrollToTop:{type:Boolean,required:!0}}},a=(s("174d"),s("2877")),n=Object(a.a)(i,function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{directives:[{name:"a11y",rawName:"v-a11y:icon",arg:"icon"},{name:"aria",rawName:"v-aria:button",value:{label:e.scrollToTop?"siq.scrolltotop":"siq.scrolltobottom"},expression:"{label: scrollToTop ? 'siq.scrolltotop' : 'siq.scrolltobottom'}",arg:"button"}],staticClass:"gototop-div size-30 curP flexM",attrs:{"data-zsqa":"goto_button"},on:{click:e.scrollHandler}},[e._t("default")],2)},[],!1,null,null,null);t.a=n.exports},"5e17":function(e,t,s){"use strict";s("b4fa")},"5ee6":function(e,t,s){"use strict";s("2800")},6275:function(e,t,s){},"63e5":function(e,t,s){},"64f3":function(e,t,s){"use strict";s("1734")},"68dc":function(e,t,s){},"69d7":function(e,t,s){"use strict";var i=s("1436"),a=s("2f62"),n=s("7c1d"),o=s("e335"),r={name:"DepartmentSelectionItem",props:{departmentDetail:{type:Object,required:!0},onSelection:Function},data(){let e=this.departmentDetail,t=e.engaged||e.is_engaged;return{deptName:Object(o.a)(e.name),metaMapping:{engaged:["siq.engaged","tag-engage","engage-circle"],online:["siq.online","tag-online","online-circle"],offline:["siq.offline","tag-offline","offline-circle"]}[t?"engaged":e.status?"online":"offline"]}},components:{Tag:n.default}},l=r,c=(s("a1a4"),s("2877")),d=Object(c.a)(l,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Tag",{directives:[{name:"title",rawName:"v-title",value:e.$doI18N(e.metaMapping[0]),expression:"$doI18N(metaMapping[0])"}],class:e.metaMapping[1],attrs:{name:e.deptName,clickHandler:function(){return e.onSelection(e.departmentDetail)}},scopedSlots:e._u([{key:"post-slot",fn:function(){return[s("Icon",{class:[e.metaMapping[2],"mL10"]})]},proxy:!0}])})},[],!1,null,"0c2ea81a",null),h=d.exports,m={name:"DepartmentSelection",props:{onSelection:{type:Function,default:()=>{}}},computed:{...Object(a.b)("embedstore",["chatDepartments"])},components:{DepartmentSelectionItem:h}},u=Object(c.a)(m,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"aria",rawName:"v-aria:list",arg:"list"}],staticClass:"wh100 textR mT30"},e._l(e.chatDepartments,function(t){return s("DepartmentSelectionItem",{key:t.id,attrs:{"department-detail":t,"on-selection":e.onSelection}})}),1)},[],!1,null,null,null),p=u.exports,g=s("0970"),f=s("e6fd"),v=s("c2cc"),C=s("68da"),b=s("6661"),y=s("ef71"),_=s("8db4"),D=s("50a8"),w=s("cdb6"),I=s("c1a6"),M=s("4b5f"),T=s("f6fb"),S=s("390b"),k={name:"ConversationAttachmentMessage",props:{fileData:{type:Object,required:!0},chatId:{type:String,required:!0},showPreview:{type:Boolean,default:!0},isSending:{type:Boolean,default:!0}},data(){let{fileData:e}=this;return{url:e.url,type:e.type,dataSrc:e.blur_image,isImageFile:Object(I.b)(e),fileSize:Object(I.h)(e.size),editorLoaded:!1}},mounted(){this.filePreview&&this.loadAceEditor()},watch:{isSending(e){e||this.$nextTick(()=>{this.loadAceEditor()})}},inject:["openFilePreview","scrollToNewMsg"],computed:{editorId(){return"editor"+this.fileData.id},filePreview(){return Object(_.B)().dynamicConf.offlineVoiceNoteInTranscriptEnabled&&(this.fileData.snippet||{}).preview||""},totalSnippetLines(){return(this.fileData.snippet||{}).lines},showAllLinesLabel(){return`${this.$doI18N("siq.showall")} (${this.totalSnippetLines} ${this.$doI18N("siq.lines")})`}},methods:{handleFileDownload(){Object(I.c)(this.fileData.durl,this.fileData.name)},loadAceEditor(){this.filePreview&&new S.a({id:this.editorId,options:{mode:"javascript",readOnly:!0,showGutter:!0,showLineNumbers:!0,highlightActiveLine:!1,maxLines:1/0,wrap:!0,showFoldWidgets:!1},content:this.filePreview,onReady:()=>{this.editorLoaded=!0,this.scrollToNewMsg(this.chatId)}})}},components:{ImageFile:M.a,AttachmentFileIcon:T.a}},F=k,j=(s("48de"),s("8446"),Object(c.a)(F,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",e._g({staticClass:"attach-wrap",class:{curP:e.showPreview},attrs:{"data-zsqa":"attachment_preview"}},e.showPreview?{click:function(){return e.openFilePreview(e.fileData.id)}}:{}),[e.filePreview?s("div",{staticClass:"editor-container"},[s("div",{staticClass:"ace-editor",attrs:{id:e.editorId},on:{click:function(e){e.stopPropagation()}}}),!e.isSending&&e.editorLoaded&&e.totalSnippetLines>1?s("div",{staticClass:"toggle-more-wrap"},[s("div",{staticClass:"ace-cell"}),s("div",{staticClass:"toggle-more"},[e._v(" "+e._s(e.showAllLinesLabel)+" ")])]):e._e()]):e._e(),e.isImageFile?s("div",{staticClass:"posrel w100 conv-trans-attach"},[s("ImageFile",{staticClass:"siqcw-attimage",class:{"cur-zoom":e.showPreview},attrs:{imgSrc:e.url,type:e.type,dataSrc:e.dataSrc,alt:"attachment"}}),s("div",{staticClass:"flexC file-detl-wrap"},[s("div",{staticClass:"file-detl-div flexG ovrflw-hid lineN mR10"},[s("div",{directives:[{name:"title",rawName:"v-title.isElips",value:e.fileData.name,expression:"fileData.name",modifiers:{isElips:!0}}],staticClass:"font13 w100 elips"},[e._v(e._s(e.fileData.name))]),s("div",{staticClass:"font11 clr8 mT5"},[e._v(e._s(e.fileSize))])]),s("Icon",{staticClass:"siqico-dwnld prvw-dwnld clr8-dark ifont18 fshrink",attrs:{clickHandler:e.handleFileDownload,a11yArg:"icon",ariaValue:{label:"siq.download"},"data-zsqa":"download_btn"}})],1)],1):[s("div",{staticClass:"flexM w100 file-detl-wrap"},[s("div",{directives:[{name:"a11y",rawName:"v-a11y"},{name:"aria",rawName:"v-aria:button",value:{label:"siq.download"},expression:"{label: 'siq.download'}",arg:"button"}],staticClass:"curP attach-msg-icon ifont14 flexM clrA fshrink",attrs:{"data-zsqa":"download_button"}},[s("AttachmentFileIcon",{attrs:{fileName:e.fileData.name,fontClass:"ifont30"}})],1),s("div",{staticClass:"file-detl-div mL10 mR15 flexG ovrflw-hid lineN"},[s("div",{directives:[{name:"title",rawName:"v-title.isElips",value:e.fileData.name,expression:"fileData.name",modifiers:{isElips:!0}}],staticClass:"font13 w100 elips"},[e._v(e._s(e.fileData.name))]),s("div",{staticClass:"font11 clr8 mT5"},[e._v(e._s(e.fileSize))])]),s("Icon",{staticClass:"siqico-dwnld prvw-dwnld clr8-dark fshrink ifont18",attrs:{clickHandler:e.handleFileDownload,a11yArg:"icon",ariaValue:{label:"siq.download"},"data-zsqa":"download_btn"}})],1)]],2)},[],!1,null,"0707027a",null)),E=j.exports,q={name:"ConversationMessageBubbleActions",props:{actions:{type:Array,required:!0},onAction:{type:Function,required:!0},isVisitorMsg:{type:Boolean,required:!0},parentElement:{type:HTMLElement,required:!0}},data:()=>({isRightAligned:!1}),mounted(){this.setAlignment()},methods:{setAlignment(){let e=this.$el.offsetWidth>this.parentElement.offsetWidth;this.isRightAligned=this.isVisitorMsg?e:!e}}},O=q,x=(s("9fc5"),s("ac55"),Object(c.a)(O,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flexC siqcw-msg-act-cont clr6",class:{"right-align":e.isRightAligned}},e._l(e.actions,function(t,i){return s("span",{directives:[{name:"title",rawName:"v-title",value:t.title,expression:"action.title"}],key:t.key,staticClass:"flexC h100",attrs:{"data-zsqa":t.key},on:{click:function(s){return e.onAction(t.key)}}},[s("icon",{directives:[{name:"a11y",rawName:"v-a11y"},{name:"aria",rawName:"v-aria:button",value:{label:t.title},expression:"{label: action.title}",arg:"button"}],staticClass:"curP siqcw-msgact-item ifont15",class:[t.iconClass]}),e.actions[i+1]?s("em",{class:{"v-divider":!!e.actions[i+1]}}):e._e()],1)}),0)},[],!1,null,"4fba41f3",null)),B=x.exports,N=s("9f0e"),L=s("fc70"),$=s("e00d"),A=s("7763"),R=s("2949"),P=s("d59b"),V={name:"ConversationFeedbackMessage",props:{messageDetail:{type:Object,required:!0}},data:()=>({isExpanded:!1}),computed:{...Object(a.d)("embedstore",["embedDetail"]),rating(){return this.messageDetail.rating},isRatingOverrideDisabled(){return this.embedDetail.dynamicConf.isRatingOverrideDisabled}},inject:["dispatchAction","getChatDetail"],methods:{sendRating(e){this.messageDetail.rating=e,this.dispatchAction("sendRating",{data:{rating:e.key}}).then(()=>{let t=this.getChatDetail();Object(A.a)($.b.RATING,{rating:e.key,visitid:t.visitId,attenderemail:t.attenderEmail})}),this.isExpanded=!1}},components:{ConversationRatingEmoji:R.a,ConversationRatingEmojiList:P.a}},H=V,W=(s("819e"),s("5ee6"),Object(c.a)(H,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"feedback-msg-cont curP"},[e.isExpanded?s("ConversationRatingEmojiList",{attrs:{rating:e.rating.key,title:e.title,handleRating:e.sendRating}}):[s("div",{staticClass:"clr6 mT15 fw600"},[e._v(e._s(e._f("i18n")(e.rating.title)))]),s("ConversationRatingEmoji",{directives:[{name:"a11y",rawName:"v-a11y:box",arg:"box"},{name:"aria",rawName:"v-aria",value:{label:e.rating.title},expression:"{ label : rating.title }"}],class:{"cur-def":e.isRatingOverrideDisabled},attrs:{emojiKey:e.rating.key,title:e.rating.title,isSelected:!0,"data-zsqa":"expand_feedback_emoji"},nativeOn:{click:function(t){e.isExpanded=!e.isRatingOverrideDisabled}}})]],2)},[],!1,null,"bbd4757e",null)),z=W.exports,U=(s("348f"),{name:"ConversationArticleMessage",props:{articleId:{type:String,required:!0},title:{type:String,required:!0},langCode:{type:String,default:""}},data:()=>({cardHeight:0}),mounted(){this.cardHeight=this.$refs.article.offsetHeight+"px"},methods:{openArticle(){this.$openResource(this.articleId,this.langCode,"article")}}}),G=(s("357e"),Object(c.a)(U,function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"mB15",style:{height:e.cardHeight}},[e._m(0)])},[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"a11y",rawName:"v-a11y"},{name:"aria",rawName:"v-aria:link",arg:"link"}],ref:"article",staticClass:"curP article-focus",attrs:{"data-zsqa":"article"},on:{click:e.openArticle}},[s("div",{staticClass:"clr9"},[s("Icon",{staticClass:"siqico-faqarticle mR5"}),e._v(" "+e._s(e._f("i18n")("faq.article"))+" ")],1),s("div",{staticClass:"mT10 article-title"},[e._v(e._s(e.title))])])}],!1,null,null,null)),Q=G.exports,X=s("ed8b"),K=s("00a1"),J={name:"ConversationRelatedPhrases",mixins:[X.a],props:{config:{type:Object,default:()=>({})},clickHandler:{type:Function,default:()=>{}}},data:()=>({}),methods:{handleResourceClick(e){if("faq"===e.type){let t={meta:JSON.stringify({type:"related_phrases",value:e.text}),text:e.text};this.clickHandler(t)}else this.showArticle(e)}},components:{Icon:K.a}},Y=J,Z=Object(c.a)(Y,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"wh100 rel-phrases",attrs:{"data-zsqa":"rel_phrases_section"}},[s("div",{staticClass:"font16"},[e._v(e._s(e.config.title))]),e._l(e.config.list,function(t,i){return s("div",{key:t.type+"_"+i,staticClass:"flex flexT mT10"},[s("icon",{staticClass:"siqico-radio ifont10 mT5 clr6"}),s("div",{directives:[{name:"a11y",rawName:"v-a11y:link",arg:"link"},{name:"aria",rawName:"v-aria:link",value:{label:t.text+" "+t.type},expression:"{label: `${item.text} ${item.type}`}",arg:"link"}],staticClass:"mL10 clrB curP",attrs:{"data-zsqa":"relatedarticles_"+i},on:{click:function(){return e.handleResourceClick(t)}}},[e._v(" "+e._s(t.text)+" ")])],1)})],2)},[],!1,null,null,null),ee=Z.exports;const te=()=>s.e("LocationWidget").then(s.bind(null,"6774"));var se={name:"ConversationMessageBubbleDisplayCard",props:{cardData:{type:Object,required:!0}},data(){return{imgUrl:this.cardData.value.image}},methods:{clickHandler(){var e;if("location"===(null===(e=this.cardData)||void 0===e?void 0:e.type))return this.showLocation()},showLocation(){var e;let{lat:t=0,lng:s=0}=(null===(e=this.cardData)||void 0===e?void 0:e.value)||{};this.$showDialog({title:this.cardData.title,latitude:parseFloat(t),longitude:parseFloat(s),hasFooter:!1,closeHandler:this.$closeDialog},te)}},components:{ImageFile:M.a}},ie=se,ae=(s("e5ce"),Object(c.a)(ie,function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.imgUrl?s("ImageFile",{staticClass:"display-card-image curP",attrs:{imgSrc:e.imgUrl,clickHandler:e.clickHandler,"data-zsqa":"display-image-card"}}):e._e()},[],!1,null,"14a4b232",null)),ne=ae.exports,oe=s("be50"),re={name:"ConversationAudioPlayer",props:{fileData:{type:Object,required:!0}},methods:{onDownload(){let{fileData:e}=this;Object(I.c)(e.durl,e.name)}},components:{AudioPlayer:oe.a}},le=re,ce=Object(c.a)(le,function(){var e=this,t=e.$createElement;return(e._self._c||t)("audio-player",{attrs:{fileObject:e.fileData,onDownload:e.onDownload}})},[],!1,null,null,null),de=ce.exports,he=(s("ac6a"),s("5f02")),me=s("c95e"),ue=s("b8c0"),pe=s("c153"),ge={name:"ChatFormNameField",props:{field:{type:Object,default:()=>({})}},data:()=>({values:{}}),inject:["handleSalutationSelection","assignVisitorValues","handleChatFormSend"],computed:{formattedField(){return Object(he.a)(this.field,this)}},mounted(){this.getNameField().setFocus()},methods:{getNameField(){return this.$refs.nameField},submitName(){this.getNameField().isValidField(this.values)&&this.handleChatFormSend(this.getName())},getName(){let{values:e}=this,t=this.getNameField();return`${e[g.j.salutation]||""} ${t.inputFields.map(e=>t.nameValues[e.meta.field_name]).join(" ")}`.trim()},onSalutationUpdate(e){this.values[g.j.salutation]=e,this.handleSalutationSelection(e)},handleUpdate(e,t){this.assignVisitorValues(e,t)}},components:{NameField:ue.a,Button:pe.a,ConversationFormWrapper:me.a}},fe=ge,ve=Object(c.a)(fe,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ConversationFormWrapper",{staticClass:"mB20"},[s("NameField",{ref:"nameField",attrs:{fields:e.formattedField.config.fields,onNameUpdate:e.handleUpdate,onSalutationUpdate:e.onSalutationUpdate}}),s("div",{staticClass:"flexM mT20"},[s("Button",{attrs:{text:e.$doI18N("siq.submit"),clickHandler:e.submitName}})],1)],1)},[],!1,null,null,null),Ce=ve.exports,be={name:"SalutationSelectionItem",props:{salutationDetail:{type:Object,required:!0},onSelection:{type:Function,default:()=>{}},selectedItem:{type:String,default:""}},data:()=>({}),components:{Tag:n.default}},ye=(s("4ecc"),Object(c.a)(be,function(){var e=this,t=e.$createElement;return(e._self._c||t)("Tag",{class:{sel:e.selectedItem===e.salutationDetail.id},attrs:{name:e.salutationDetail.title,clickHandler:function(){return e.onSelection(e.salutationDetail)}}})},[],!1,null,"46002eca",null)),_e=ye.exports,De={name:"SalutationSelection",props:{onSalutationSelection:{type:Function,default:()=>{}}},data:()=>({salutationList:Object(_.S)(),selectedItem:f.t?"Mr":""}),methods:{onSelection({id:e}){this.selectedItem=this.selectedItem===e?"":e,this.onSalutationSelection(e)}},components:{SalutationSelectionItem:_e}},we=De,Ie=Object(c.a)(we,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"aria",rawName:"v-aria:list",arg:"list"}],staticClass:"wh100 textR mT30"},e._l(e.salutationList,function(t){return s("SalutationSelectionItem",{key:t.id,attrs:{salutationDetail:t,onSelection:e.onSelection,selectedItem:e.selectedItem}})}),1)},[],!1,null,null,null),Me=Ie.exports,Te=s("eada"),Se=s("05a0"),ke={name:"ConversationSurveyMessage",props:{message:String,url:String},methods:{openSurvey(){y.c?Object(Te.a)(this.url):Se.a.sendPostMessage("opensurvey",this.url)}}},Fe=Object(c.a)(ke,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mB15 curP",on:{click:e.openSurvey}},[s("span",{staticClass:"fw600"},[e._v(e._s(e.message))]),s("div",{staticClass:"mT10"},[e._v(" Zoho survey ")])])},[],!1,null,null,null),je=Fe.exports,Ee=s("b6be"),qe=s("d05b"),Oe=s("2c40"),xe={inject:{chatConfig:{default:()=>({})},...["hasMsgActions","checkIfSupportedOperation","onMsgReply","isMsgModificationAllowed","dispatchAction","handleMsgDelete","handleMsgEdit"].reduce((e,t)=>(e[t]=v.a,e),{})},computed:{isMessageActionSupported(){return this.hasMsgActions()&&!(this.isSending||(()=>{let{messageDetail:e}=this;return e.form||e.deleted})())},isReplyMessageSupported(){return this.isMessageActionSupported&&this.checkIfSupportedOperation("reply_message")},msgActions(){if(!this.isMessageActionSupported)return[];let e=[],t=!this.meta.is_question&&this.isVisitorMsg&&this.isMsgModificationAllowed(this.time),s=f.e?{edit:this.chatConfig.allow_message_edit,delete:this.chatConfig.allow_message_delete}:this.embedDetail.messageActionConfig.visitor,{checkIfSupportedOperation:i}=this;return this.isReplyMessageSupported&&e.push({title:this.$doI18N("siq.reply"),key:"reply",iconClass:"siqico-reply"}),t&&s.edit&&i("edit_message")&&e.push({title:this.$doI18N("siq.editmsg"),key:"edit",iconClass:"siqico-edit"}),t&&s.delete&&i("delete_message")&&e.push({title:this.$doI18N("siq.delete"),key:"delete",iconClass:"siqico-delico"}),e}},methods:{handleMessageAction(e){({reply:this.handleReply,delete:()=>this.handleMsgDelete(this.id),edit:()=>this.handleMsgEdit(this.id,this.displayText,this.fileData?"comment":"text")})[e]()},handleReply(e){e&&this.$refs.msgCont.contains(e.target)||this.onMsgReply(this.id)},resendMessages(){Object(Oe.h)(this.chatId)}}};var Be={name:"ConversationMessageBubble",mixins:[qe.a,xe],props:{isSingleMsg:{type:Boolean,default:!1}},data:()=>({isMsgHovered:!1,isMsgLongPressed:!1,isMobileDevice:y.c,wrapperClass:"",messageTimeWidth:0,SuggestionsWidget:()=>s.e("SuggestionsWidget").then(s.bind(null,"d774"))}),provide(){return{updateWrapperClass:e=>this.wrapperClass=e}},inject:["checkIsLastMsg","scrollToNewMsg","skipFormField","getChatDetail","handlePreChatForm","handleCampaignOption","handleDeptSelection","handleSalutationSelection","isBotTypingShown","checkIsFailedMsg","getChatBodyEl","updateContainerClass","scrollToBottom"].reduce((e,t)=>(e[t]=v.a,e),{}),computed:{...Object(a.d)("embedstore",["embedDetail"]),isActiveBotWidget(){return!this.isVisitorMsg&&this.isLastMessage&&!this.isBotTypingShown()&&this.getChatDetail().isBot},isLiveChat(){return this.getChatDetail().status===g.g.live},isLastMessage(){return this.checkIsLastMsg(this.id)},isFailedMsg(){return this.checkIsFailedMsg(this.id)},hasSkippable(){return this.meta.skippable},hasAttachmentImg(){return this.attachmentImg&&!this.wrapperClass},hasAudioAttachment(){return(e={type:""})=>{let t=e.type;return this.isAudioFile(t)&&!this.wrapperClass}},attachmentImg(){var e;return null===(e=this.meta.display_card)||void 0===e?void 0:e.image},botWrapperClass(){return!this.isActiveBotWidget||this.attachmentImg?"past-bot-msg":""},isAudioFile:()=>e=>e&&e.includes("audio")&&!e.endsWith("/amr"),hasCardData(){return this.meta.card_data||"location"===this.meta.type},displayCardData(){return{..."location"===this.meta.type?this.meta:this.meta.card_data,title:this.displayText}},isPreview:()=>f.t,allowAnimation(){return!!this.messageDetail.new},feedbackMsg(){return this.messageDetail.feedback&&Object(C.a)("```"+this.messageDetail.feedback+"```",{markdown:!0,emojiClass:"siqsly",hasEmoji:!0}).replace(/\n|\\n/gm,"<br />")},showMessageAction(){return y.c?this.isMsgLongPressed:this.isMsgHovered}},mounted(){this.initWatcher()},beforeDestroy(){this.unwatch()},methods:{initWatcher(){this.unwatch=this.$watch(()=>!this.isSending&&this.isVisitorMsg&&this.isLiveChat||this.isSending&&!this.isFailedMsg,this.setMessageTimeWidth,{immediate:!0})},handleAnimationEnd(){this.$delete(this.messageDetail,"new")},setMessageTimeWidth(){let e=this.$refs.message_time;e&&(this.messageTimeWidth=e.getBoundingClientRect().width)},toggleLongPress(e){this.isMsgLongPressed=e},onBubbleEnter(e,t){let s=this.embedDetail.dynamicConf.allowBottomScroll;if(!this.allowAnimation&&!s)return;this.updateContainerClass("ovrflw-hid");let i=this.getChatBodyEl(),a=(this.isSingleMsg?e.parentElement.offsetHeight+2*parseFloat(window.getComputedStyle(e.parentElement).marginBottom):e.offsetHeight)+Object(_.T)(e),n=!this.getChatDetail().isBot&&!this.messageDetail.meta.custom_message_id&&(!Object(_.jb)()||this.isVisitorMsg||i.scrollHeight-(i.scrollTop+i.clientHeight)<=a),o=i.scrollHeight>i.offsetHeight,r=o&&n;n&&(r?i.scrollTo({top:i.scrollTop-0,behavior:"smooth"}):this.handleNoScrollAnim(i,e)),e.onanimationend=()=>{this.setElTranslateYValue(e,0),this.handleAnimationEnd(),this.updateContainerClass(),r||(this.setElTranslateYValue(i,0),this.toogleScrollAnim(i,!1)),t()},setTimeout(()=>{o&&s?this.scrollToBottom("",!0):r&&this.startMsgAnimation(i,e.offsetHeight,10,r)},56)},toogleScrollAnim(e,t){e.classList[t?"add":"remove"]("trans-noscrol-anim")},handleNoScrollAnim(e,t){e.style.cssText=`--chatbody-transY: ${t.offsetHeight}px`,this.toogleScrollAnim(e,!0)},startMsgAnimation(e,t,s,i){s<0?i&&e.scrollTo({top:e.scrollHeight-e.offsetHeight,behavior:"smooth"}):(i?e.scrollTo({top:e.scrollTop+t/10,left:0,behavior:"smooth"}):this.setElTranslateYValue(e,t-10*(10-s)),this.startMsgAnimation(e,t,s-1,i))},setElTranslateYValue(e,t){t=t<0?0:t,e.style.transform=`translate3D(0.00px,${t}px,0.00px)`},updateVisitorMeta(e){if(!e)return;let t="name"===(e=JSON.parse(e)).type?"last_name":e.type;g.c.includes(t)&&Object(b.h)({[t]:e.value})},handleWidgetSubmit(e){if(this.updateVisitorMeta(e.meta),this.getChatDetail().isBotTrigger&&!this.isPreview)return this.handlePreChatForm(e.text,e.meta);e.type&&"file"===e.type&&this.handleFormAttachmentSubmit(e.file),this.sendTextMessage(e)},handleFormAttachmentSubmit(e){Ee.a.sendFormAttachments({chatId:this.chatId,attachments:e})},handleBotAction(e){this.sendTextMessage({text:e.title,command:e.id})},relatedPhraseHandler(e){this.isLiveChat&&this.sendTextMessage(e)},sendTextMessage(e){Ee.a.sendTextMessage({chatId:this.chatId,...e})}},watch:{isLastMessage(){this.$nextTick(this.setMessageTimeWidth)}},components:{Tag:n.default,DepartmentSelection:p,BotWidget:()=>s.e("BotWidget").then(s.bind(null,"aa72")),BotSkip:()=>s.e("BotWidgetSkip").then(s.bind(null,"ebe8")),BotActions:()=>s.e("BotWidget").then(s.bind(null,"b76c")),MessageBubbleContainer:D.a,MessageBubbleWrap:w.a,ConversationAttachmentMessage:E,ConversationMessageBubbleActions:B,ConversationQuotedMessage:N.a,ConversationTextMessage:L.a,ConversationMessageBubbleDisplayCard:ne,ConversationSurveyMessage:je,ConversationFeedbackMessage:z,ConversationArticleMessage:Q,ConversationRelatedPhrases:ee,ConversationAudioPlayer:de,ChatFormNameField:Ce,SalutationSelection:Me}},Ne=Be,Le=(s("9c79"),s("0439"),Object(c.a)(Ne,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("transition",{attrs:{name:e.allowAnimation?"bubble":"",appear:""},on:{enter:e.onBubbleEnter}},[s("MessageBubbleContainer",{class:{"chat-sugges-cont":e.meta.suggestions},attrs:{id:e.id,listeners:Object.assign({},{mouseenter:function(){return e.isMsgHovered=!0},mouseleave:function(){return e.isMsgHovered=!1}},e.isReplyMessageSupported?{dblclick:e.handleReply}:{},e.messageDetail.new?{animationend:e.handleAnimationEnd}:{}),"data-zsqa":e.isVisitorMsg?"visitor_msg message_bubble":"agent_msg message_bubble"}},[e.isFailedMsg?s("Icon",{staticClass:"siqico-retry clrR ifont16 mR10",attrs:{"click-handler":e.resendMessages,title:"siq.resend",a11yArg:"box",ariaValue:{label:"siq.resend"},"data-zsqa":"retry_btn"}}):e._e(),e.messageDetail.id?s("MessageBubbleWrap",e._g({directives:[{name:"click-out",rawName:"v-click-out:[{isEnabled:showMessageAction}]",value:function(){return e.toggleLongPress(!1)},expression:"() => toggleLongPress(false)",arg:{isEnabled:e.showMessageAction}},{name:"longpress",rawName:"v-longpress:[{isEnabled:!showMessageAction,supportedDevice:isMobileDevice}]",value:function(){return e.toggleLongPress(!0)},expression:"() => toggleLongPress(true)",arg:{isEnabled:!e.showMessageAction,supportedDevice:e.isMobileDevice}}],ref:"msgCont",class:e.messageDetail.deleted?[]:[e.wrapperClass,e.botWrapperClass,{"reply-msg":e.replyDetail,"attach-msg-cont":e.fileData,sending:e.isSending,"feedback-msg mB15":!!e.messageDetail.rating,"article-msg-card":e.meta.article||e.meta.related_phrases||e.isSurveyMsg,"display-card":e.hasCardData,"attach-img":e.hasAttachmentImg,"audio-attachment":e.hasAudioAttachment(e.fileData)}]},e.isMobileDevice?{dblclick:function(){return e.toggleLongPress(!0)}}:{}),[e.messageDetail.deleted?s("span",{staticClass:"delete-msg italic",attrs:{"data-zsqa":"deleted_msg"}},[s("Icon",{staticClass:"siqico-deletemsg mR5"}),s("span",{attrs:{"data-zsqa":"msg"}},[e._v(e._s(e._f("i18n")("msg.chat.delete")))]),s("span",{staticClass:"virtual-div mL10 dib-mid",style:{width:e.messageTimeWidth+"px"}})],1):[e.replyDetail?s("ConversationQuotedMessage",{staticClass:"chat-quote-msg",attrs:{messageId:e.replyDetail.id,quotedDetail:e.replyDetail}}):e._e(),e.showMessageAction&&e.msgActions.length?s("ConversationMessageBubbleActions",{attrs:{actions:e.msgActions,chatId:e.chatId,onAction:e.handleMessageAction,isVisitorMsg:e.isVisitorMsg&&!e.isTriggerMsg,parentElement:e.$refs.msgCont.$el}}):e._e(),e.isBotWidget?[s("BotWidget",{attrs:{detail:e.messageDetail,onSubmit:e.handleWidgetSubmit,isActive:e.isActiveBotWidget},scopedSlots:e._u([{key:"post-slot",fn:function(){return[e.isActiveBotWidget&&e.hasSkippable?s("BotSkip",{attrs:{onSubmit:e.handleWidgetSubmit}}):e._e()]},proxy:!0}],null,!1,2994869335)})]:e.meta.article?s("ConversationArticleMessage",{attrs:{articleId:e.meta.article,langCode:e.meta.language_code||"",title:e.meta.title}}):e.isSurveyMsg?s("ConversationSurveyMessage",{attrs:{message:e.displayText,url:e.meta.url}}):e.meta.related_phrases?s("ConversationRelatedPhrases",{attrs:{config:e.meta.related_phrases,clickHandler:e.relatedPhraseHandler}}):[e.hasCardData?s("ConversationMessageBubbleDisplayCard",{attrs:{cardData:e.displayCardData}}):e._e(),e.fileData?[e.isAudioFile(e.fileData.type)?s("ConversationAudioPlayer",{attrs:{fileData:e.fileData}}):s("ConversationAttachmentMessage",{attrs:{fileData:e.fileData,chatId:e.chatId,showPreview:!e.isSending&&!e.isPreview,isSending:e.isSending}})]:e._e(),e.displayText?s("ConversationTextMessage",{staticClass:"textmsg-div",class:{"reply-msg-cont":e.replyDetail,"siqcw-att-cmt siqico-quote justifyT":e.fileData,"widget-card-title":e.hasCardData},attrs:{message:e.displayText,isEdited:e.messageDetail.edited,isVisitorMsg:e.isVisitorMsg&&!e.meta.form_message},scopedSlots:e._u([{key:"custom",fn:function(){return[s("span",{staticClass:"virtual-div mL10 dib-mid",style:{width:e.messageTimeWidth+"px"}})]},proxy:!0}],null,!1,110022636)}):e._e(),e.messageDetail.campaignOption&&e.isLastMessage?s("div",{staticClass:"mT15 tag-wrap"},e._l(e.messageDetail.campaignOption,function(t){return s("Tag",{key:t.id,attrs:{name:t.title,clickHandler:function(){return e.handleCampaignOption(t)}}})}),1):e._e()]],e.messageDetail.rating?s("ConversationFeedbackMessage",{attrs:{messageDetail:e.messageDetail}}):e._e(),e.feedbackMsg?s("div",{directives:[{name:"title",rawName:"v-title.isElips.isHtml",value:e.feedbackMsg,expression:"feedbackMsg",modifiers:{isElips:!0,isHtml:!0}},{name:"shtml",rawName:"v-shtml",value:e.feedbackMsg,expression:"feedbackMsg"}],staticClass:"fdbkmsg mT10 mB15 fw600",attrs:{"data-zsqa":"fdbkmsg"}}):e._e(),s("div",{ref:"message_time",staticClass:"flexC bubble-time",class:{justifyE:e.isVisitorMsg},attrs:{"data-zsqa":"readreceipt_section"}},[s("span",{attrs:{"data-zsqa":"msg_time"}},[e._v(e._s(e.messageTime))]),e.isSending&&!e.isFailedMsg?s("Icon",{staticClass:"siqico-clock ifont16 mL5"}):!e.isSending&&e.isVisitorMsg&&e.isLiveChat&&e.isMessageActionSupported&&e.isLastMessage?s("Icon",{directives:[{name:"title",rawName:"v-title:bottom",value:e.$doI18N(e.messageDetail.is_read?"siq.seen":"siq.sent"),expression:"$doI18N(messageDetail.is_read ? 'siq.seen' : 'siq.sent')",arg:"bottom"}],staticClass:"ifont16 mL5",class:e.messageDetail.is_read?"siqico-seen":"siqico-tick",attrs:{"data-zsqa":e.messageDetail.is_read?"msg_seen":"msg_sent"}}):e._e()],1),e.messageDetail.nameField&&e.isLastMessage?s("ChatFormNameField",{attrs:{field:e.messageDetail.nameField}}):e._e(),e.messageDetail.isSkippable&&e.isLastMessage?s("div",{staticClass:"w100"},[s("span",{directives:[{name:"a11y",rawName:"v-a11y:box",arg:"box"},{name:"aria",rawName:"v-aria:button",value:{label:"siq.skip"},expression:"{label: 'siq.skip'}",arg:"button"}],staticClass:"clr8 mT5 mB5 curP font13 dib-mid skip-optn iflexC",attrs:{"data-zsqa":"skip_btn"},on:{click:e.skipFormField}},[e._v(" "+e._s(e._f("i18n")("siq.skip"))+" "),s("icon",{staticClass:"mL5 siqico-skip ifont12"})],1)]):e._e()],2):e._e(),e.isActiveBotWidget&&e.meta.suggestions?s("AsyncComponent",{attrs:{comp:e.SuggestionsWidget,compProps:{suggestions:e.meta.suggestions,onSubmitHandler:e.handleWidgetSubmit}}}):e._e(),(e.meta.rollback_command||e.meta.restart_command)&&e.isActiveBotWidget&&!e.isPreview?s("BotActions",{attrs:{hasRollback:e.meta.rollback_command,hasRestart:e.meta.restart_command,onSelect:e.handleBotAction}}):e._e(),e.messageDetail.departmentSelection&&e.isLastMessage?s("DepartmentSelection",{attrs:{onSelection:e.handleDeptSelection}}):e._e(),e.messageDetail.salutation&&(e.isLastMessage||e.isPreview)?s("SalutationSelection",{attrs:{onSalutationSelection:e.handleSalutationSelection}}):e._e()],1)],1)},[],!1,null,"be4bd54c",null)),$e=Le.exports,Ae={name:"ConversationUnreadIndicator",props:{showBgColor:{type:Boolean,default:!1}}},Re=(s("e707"),Object(c.a)(Ae,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"unread-message",class:{"unread-bgclr":e.showBgColor}},[s("span",{staticClass:"unread-msg-text"},[e._v(e._s(e._f("i18n")("chat.msgs.new")))])])},[],!1,null,null,null)),Pe=Re.exports,Ve={name:"ConversationMessageTranscriptGroup",props:{messageIds:{type:Array,required:!0},name:{type:String,required:!0},className:{type:String,default:"textL"},onNameEdit:Function,unReadMsgIdInfo:{type:Object,default:()=>({})}},data:()=>({containerClass:""}),provide(){return{updateContainerClass:(e="")=>this.containerClass=e}},computed:{groupLength(){return this.messageIds.length},showUnreadIndicator(){return e=>{let t=this.unReadMsgIdInfo.firstUnreadMsgId;return t&&e===t}},isSingleMsg(){return 1===this.groupLength}},components:{ConversationSenderName:i.a,ConversationMessageBubble:$e,ConversationUnreadIndicator:Pe}},He=Ve,We=(s("2340"),Object(c.a)(He,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex fdirection w100 mB20",class:e.containerClass},[e.showUnreadIndicator(e.messageIds[0])?s("ConversationUnreadIndicator",{attrs:{showBgColor:e.unReadMsgIdInfo.showUnreadColor}}):e._e(),s("ConversationSenderName",{class:e.className,attrs:{name:e.name,onNameEdit:e.onNameEdit}}),e.groupLength?[e._l(e.messageIds,function(t,i){return[e.showUnreadIndicator(t)&&i?s("ConversationUnreadIndicator",{key:"msg_"+t,attrs:{showBgColor:e.unReadMsgIdInfo.showUnreadColor}}):e._e(),s("ConversationMessageBubble",{key:t,class:{first_msg:!i&&1!==e.groupLength,single_msg:e.isSingleMsg,last_msg:i&&e.groupLength-1===i},attrs:{messageId:t,isSingleMsg:e.isSingleMsg}})]})]:e._t("default")],2)},[],!1,null,"16ae0cd5",null)),ze=We.exports;t.a={props:{messageIds:{type:Array,default:()=>[]},sender:{type:Object,required:!0}},components:{ConversationMessageTranscriptGroup:ze}}},"6be8":function(e,t,s){"use strict";s("2e2a")},"6df6":function(e,t,s){"use strict";var i={name:"ConversationMessageAgentGroup",mixins:[s("69d7").a],props:{unReadMsgIdInfo:{type:Object,default:()=>({})}}},a=(s("344d"),s("2877")),n=Object(a.a)(i,function(){var e=this,t=e.$createElement;return(e._self._c||t)("ConversationMessageTranscriptGroup",{staticClass:"siqcw-agentmsg-grp flexT justifyT pL15",attrs:{messageIds:e.messageIds,name:e.sender.name,unReadMsgIdInfo:e.unReadMsgIdInfo}},[e._t("default")],2)},[],!1,null,"e2ef68e8",null);t.a=n.exports},"6e90":function(e,t,s){"use strict";s("cec9")},7075:function(e,t,s){"use strict";var i={name:"ConversationConsent",props:{title:{type:String,default:""},consentCta:{type:String,default:""},onCtaClick:Function}},a=(s("8dcb"),s("2877")),n=Object(a.a)(i,function(){var e=this;e.$createElement;return e._self._c,e._m(0)},[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"textC mT30 w100 mB15 clr3"},[e.title?s("div",{staticClass:"font14 clr3"},[e._v(" "+e._s(e._f("i18n")(e.title))+" ")]):e._e(),e._t("title"),s("span",e._g({staticClass:"cnct-txt-btn mT10",class:{curP:e.onCtaClick},attrs:{"data-zsqa":"txt_btn"}},e.consentCta?{click:e.onCtaClick}:{}),[e.consentCta?s("em",{directives:[{name:"a11y",rawName:"v-a11y:link",arg:"link"},{name:"aria",rawName:"v-aria:link",value:{label:e.consentCta},expression:"{label: consentCta}",arg:"link"}]},[e._v(" "+e._s(e._f("i18n")(e.consentCta))+" ")]):e._e(),e._t("cta")],2)],2)}],!1,null,null,null);t.a=n.exports},7154:function(e,t,s){},71548:function(e,t,s){"use strict";s("a079")},"732f":function(e,t,s){"use strict";s("194a")},7362:function(e,t,s){"use strict";var i=s("2f62"),a=s("8db4"),n=s("0970"),o=s("c2cc"),r={name:"ConversationMessageVisitorGroup",inheritAttrs:!1,mixins:[s("69d7").a],inject:{getVisitorDetail:o.a,editVisitorDetail:o.a,getChatDetail:o.a},computed:{...Object(i.b)("embedstore",["hasVisitorFieldEdit"]),name(){return Object(a.K)((this.getVisitorDetail()||this.sender||{}).name)},isNameEditAllowed(){return[n.g.live,n.g.waiting].includes((this.getChatDetail()||{}).status)&&this.hasVisitorFieldEdit}}},l=(s("64f3"),s("2877")),c=Object(l.a)(r,function(){var e=this,t=e.$createElement;return(e._self._c||t)("ConversationMessageTranscriptGroup",{staticClass:"siqcw-vismsg-grp flexE pR15",attrs:{name:e.name,className:"textR",messageIds:e.messageIds,onNameEdit:e.isNameEditAllowed?e.editVisitorDetail:null}},[e._t("default")],2)},[],!1,null,"319522e4",null);t.a=c.exports},"73bc":function(e,t,s){"use strict";s("eb4b")},7433:function(e,t,s){"use strict";s("50d5")},"76d0":function(e,t,s){"use strict";s("e0a5")},7787:function(e,t,s){"use strict";var i=s("2f62"),a=s("2c40"),n=s("7942"),o=s("c2cc"),r=s("b6be"),l={name:"ConversationInfoMessage",inheritAttrs:!1,props:{messageIds:{type:Array,default:()=>[]},sender:{type:Object,default:()=>{}},staticInfoMessage:{type:String,default:""}},data:()=>({infoMessage:"",action:void 0,time:""}),inject:{getChatId:o.a,hasInfoMsgAction:o.a,startAudioCall:o.a,checkIfHasCallIcon:o.a},computed:{...Object(i.d)("conversationstore",["mediaFilesLoaded"]),showAction(){return(e=>e&&(!e.criteria||e.criteria.call(this)))(this.action)&&this.hasInfoMsgAction()}},beforeMount(){this.infoMessage=this.staticInfoMessage||this.getInfoMessage()},methods:{getInfoMessage(){let e=this.getChatId(),t=Object(a.c)(e,this.messageIds[0])||{},s=r.a.getFormattedInfoMessage(t.message,e);return this.action=s.action,this.time=Object(n.e)(t.time),s.message||s},handleAction(){this.action.onClick.call(this)}}},c=l,d=s("2877"),h=Object(d.a)(c,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"textC clr9 p15 pT10 pB10",attrs:{"data-zsqa":"infomsg_section"}},[e._v(" "+e._s(e.infoMessage)+" "),e.showAction?[s("span",{directives:[{name:"a11y",rawName:"v-a11y:link",arg:"link"},{name:"aria",rawName:"v-aria:button",value:{label:e.action.text},expression:"{label: action.text}",arg:"button"}],staticClass:"theme-clr curP mL10",on:{click:e.handleAction}},[e.action.icon?s("Icon",{class:e.action.icon}):e._e(),e._v(" "+e._s(e._f("i18n")(e.action.text))+" ")],1)]:e._e()],2)},[],!1,null,null,null);t.a=h.exports},7917:function(e,t,s){"use strict";s("7f5a")},"7aed":function(e,t,s){"use strict";s("baf7")},"7c1d":function(e,t,s){"use strict";s.r(t);var i={name:"Tag",props:{name:{type:String,required:!0},clickHandler:{type:Function,default:()=>{}},className:{type:String,default:""}}},a=(s("a935"),s("2877")),n=Object(a.a)(i,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"a11y",rawName:"v-a11y"},{name:"aria",rawName:"v-aria:listitem",value:{label:e.name},expression:"{label: name}",arg:"listitem"}],staticClass:"mB10 tag-div",class:e.className,attrs:{"data-zsqa":e.name},on:{click:function(t){return t.stopPropagation(),e.clickHandler(t)}}},[e._t("pre-slot"),s("span",[e._v(e._s(e.name))]),e._t("post-slot")],2)},[],!1,null,null,null);t.default=n.exports},"7d70":function(e,t,s){"use strict";s("fdd8")},"7f5a":function(e,t,s){},"7ffb":function(e,t,s){},"806d":function(e,t,s){},"819e":function(e,t,s){"use strict";s("a7c9")},8319:function(e,t,s){},8323:function(e,t,s){"use strict";s("f02b")},"83f1":function(e,t,s){},8446:function(e,t,s){"use strict";s("46b7")},"85c1":function(e,t,s){},"88b4":function(e,t,s){"use strict";s("2b1e")},"898a":function(e,t,s){},"8dcb":function(e,t,s){"use strict";s("7ffb")},"926f":function(e,t,s){"use strict";s("806d")},"93da":function(e,t,s){},"9aec":function(e,t,s){},"9c44":function(e,t,s){"use strict";var i=s("2f62"),a=s("fa7d"),n=s("8db4"),o=s("7763"),r=s("e00d"),l=s("e6fd"),c=s("7f80"),d=s("b6be"),h=s("1549"),m=s("d59b"),u={name:"ConversationRating",props:{chatDetail:{type:Object,required:!0},onClose:{type:Function,default:()=>{}}},inject:{chatConfig:{default:()=>({})},scrollToBottom:{default:()=>()=>{}}},data(){return{rating:"",showFeedback:!1,feedback:"",feedbackProps:{onInputChange:e=>this.feedback=e,onEnter:this.submitFeedback,autoFocus:!0,value:""}}},computed:{...Object(i.b)("embedstore",["lang"]),isCall(){return Object(n.e)(this.chatDetail)},isShowFeedback(){return this.showFeedback||this.chatDetail.showFeedback},isReactionEnabled(){let e=this.chatDetail;return(!e.isBot||!e.ratingDisabled)&&Object(n.ib)(this.isCall)},feedbackPlaceholder(){return l.e&&(this.isCall?Object(n.q)():Object(n.A)()).feedback.placeholder[this.lang]||this.$doI18N("fb.hint")},headerTxt(){let{labels:e={},rating:t,reaction:s,feedback:i}=this.isCall?Object(n.q)():Object(n.A)(),a=(t||s)&&(t||s).emoji||{title:{}};switch(!0){case this.isReactionEnabled&&Object(n.fb)(this.isCall):return a.title[this.lang]||e.feedback_and_rating||"rating.fb";case this.isReactionEnabled:return a.title[this.lang]||e.rating||"rating.title";default:return(l.e?i.message[this.lang]:e.feedback)||"fb.share"}}},mounted(){this.scrollToBottom()},watch:{"chatDetail.rating":{immediate:!0,handler(e){this.rating=e,e&&this.handleFeedback()}}},methods:{handleRating(e){this.$set(this.chatDetail,"rating",e),this.sendRating(e.key)},handleFeedback(){if(!Object(n.fb)(this.isCall))return this.closeRating();this.showFeedback=!0,this.scrollToBottom()},sendRating(e){let t={rating:e};this.dispatchRating(t).then(()=>{this.sendCallback(r.b.RATING,t)})},getFeedbackMessageObj(){let e=this.chatDetail,t=Object(n.M)(this.rating?"ratingcomplete":"feedbackcomplete")||this.$doI18N(this.rating?"rating.msg":"faq.feedback"),s=c.a.getTempTextMessageObj(Object(a.a)(),`${t} \n ${this.$doI18N("fb.msg")}`,{},e.id);return s.sender={id:(e.isBot?"b":"")+this.attenderId,name:e.attenderName},this.rating&&(s.rating=this.rating),s.feedback=this.feedback,s},postFeedbackMessage(){this.rating||d.a.appendTempMessage(this.chatDetail.id,this.getFeedbackMessageObj())},postRatingMessage(){this.rating&&d.a.appendTempMessage(this.chatDetail.id,this.getFeedbackMessageObj())},closeRating(){this.postRatingMessage(),this.onClose(),this.chatDetail.showRating=!1},submitFeedback(e,t){if(Object(n.gb)(t))return;if(t&&t.preventDefault(),!this.feedback)return this.$showBanner(this.$doI18N("all.errinfo"));let s={feedback:this.feedback};this.dispatchRating(s).then(()=>{this.postFeedbackMessage(),this.sendCallback(r.b.FEEDBACK,s)}),this.closeRating()},dispatchRating(e){return this.$store.dispatch("conversationstore/sendRating",{chatId:this.chatDetail.id,data:e,isCall:this.isCall})},sendCallback(e,t){let s=this.chatDetail;t.visitid=s.visitId,t.attenderemail=s.attenderEmail,Object(o.a)(e,t)}},components:{TextArea:h.a,ConversationRatingEmojiList:m.a}},p=u,g=(s("29ab"),s("ce30"),s("2877")),f=Object(g.a)(p,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"aria",rawName:"v-aria",value:{label:e.headerTxt},expression:"{ label: headerTxt }"}],staticClass:"siqcw-feedback-cont textC posrel",attrs:{"data-zsqa":"feedback_wrp"}},[s("Icon",{staticClass:"siqico-close siqcw-pop-close",attrs:{clickHandler:e.closeRating,a11yArg:"circle",ariaValue:{label:"siq.close"},"data-zsqa":"close_btn"}}),s("header",{staticClass:"clr6 fw600"},[e._v(e._s(e._f("i18n")(e.headerTxt)))]),e.isReactionEnabled?[s("ConversationRatingEmojiList",{staticClass:"siqcw-react-cont",attrs:{rating:e.rating&&e.rating.key,handleRating:e.handleRating,showTitle:!0}})]:e._e(),e.isShowFeedback||!e.isReactionEnabled?[e.isShowFeedback||!e.isReactionEnabled?s("TextArea",e._b({staticClass:"mT15",attrs:{placeHolder:e.feedbackPlaceholder,"data-zsqa":"feedback_cmd_section"}},"TextArea",e.feedbackProps,!1)):e._e(),s("Icon",{staticClass:"siqico-send ifont18 mL10",class:{"feedback-enable":e.feedback},attrs:{isDisabled:!e.feedback,clickHandler:e.submitFeedback,ariaValue:{label:"siq.send",disabled:!e.feedback},a11yArg:"icon"}})]:e._e()],2)},[],!1,null,"12399505",null);t.a=f.exports},"9c79":function(e,t,s){"use strict";s("83f1")},"9e1e8":function(e,t,s){},"9f0e":function(e,t,s){"use strict";var i=s("8db4"),a=s("c1a6"),n=s("7942"),o=s("00a1"),r=s("4b5f"),l=s("f6fb"),c=s("fc70"),d={name:"ConversationQuotedMessage",mixins:[s("d05b").a],props:{quotedDetail:Object,onClose:Function},inject:["scrollToMsg","getVisitorDetail","hasHeaderOption"],computed:{senderName(){return this.isVisitorMsg&&Object(i.K)(this.getVisitorDetail().name)||this.messageDetail.sender.name},fileName(){return this.fileData.name},fileUrl(){return Object(i.F)(this.fileData,this.chatId)},messageTime(){return Object(n.e)(this.time)},isImageFile(){let e=this.fileData;return e&&Object(a.b)(e)}},watch:{"messageDetail.deleted"(e){var t;e&&(null===(t=this.onClose)||void 0===t||t.call(this))}},components:{Icon:o.a,ConversationTextMessage:c.a,ImageFile:r.a,AttachmentFileIcon:l.a}},h=d,m=(s("5b49"),s("ae90"),s("2877")),u=Object(m.a)(h,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"siqcw-quote-cont curP flexC",class:{posabs:!!e.onClose,"more-optn-hdr":e.hasHeaderOption},attrs:{"data-zsqa":"reply_msg_section"},on:{click:function(t){return t.preventDefault(),e.scrollToMsg(e.id)}}},[e.fileData?s("div",{staticClass:"mR10"},[e.isImageFile?s("ImageFile",{staticClass:"quote-img-file",attrs:{className:"obj-cover",imgSrc:e.fileUrl,alt:e.fileName}}):s("AttachmentFileIcon",{attrs:{fileName:e.fileName,fontClass:"ifont30"}})],1):e._e(),s("div",{staticClass:"flexG ovrflw-hid lineN"},[s("div",{staticClass:"flexC clr3"},[s("Icon",{staticClass:"siqico-reply ifont15"}),s("span",{directives:[{name:"title",rawName:"v-title.isElips",value:e.senderName,expression:"senderName",modifiers:{isElips:!0}}],staticClass:"mR10 mL5 flexG elips"},[e._v(e._s(e.senderName))]),s("span",{staticClass:"v-divider mLR10"}),s("span",{staticClass:"clr9 font12 fshrink"},[e._v(e._s(e.messageTime))]),e.onClose?s("Icon",{directives:[{name:"key",rawName:"v-key.escape",value:e.onClose,expression:"onClose",modifiers:{escape:!0}}],staticClass:"siqico-close mL10 siqcw-pop-close pos-sta",attrs:{clickHandler:e.onClose,a11yArg:"circle",ariaValue:{label:"siq.close"},"data-zsqa":"close_btn"}}):e._e()],1),s("div",{staticClass:"flexC mT5"},[e.messageDetail.meta&&e.messageDetail.meta.article?s("Icon",{staticClass:"siqico-faqarticle mR5 clr7-dark ifont16"}):e._e(),s("ConversationTextMessage",{staticClass:"clr6 ovrflw-hid",attrs:{className:"elips",message:e.displayText||e.fileName,convertEmoji:!e.fileData,processMsg:!e.fileData,isVisitorMsg:e.isVisitorMsg&&!e.isTriggerMsg,hasElips:!0}})],1)])])},[],!1,null,"b6f460a8",null);t.a=u.exports},"9fc5":function(e,t,s){"use strict";s("c25b")},a079:function(e,t,s){},a1a4:function(e,t,s){"use strict";s("53d7")},a2eb:function(e,t,s){"use strict";var i={name:"ConversationComposerWrap"},a=(s("732f"),s("2877")),n=Object(a.a)(i,function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"siqcw-textarea-composer siqcw-composer",attrs:{"data-zsqa":"conv_composer"}},[e._t("default")],2)},[],!1,null,"89945770",null);t.a=n.exports},a7c9:function(e,t,s){},a7f5:function(e,t,s){},a935:function(e,t,s){"use strict";s("05da")},a959:function(e,t,s){},abfa:function(e,t,s){"use strict";s("4d9a")},ac55:function(e,t,s){"use strict";s("a959")},ad5b:function(e,t,s){"use strict";s("6275")},ae90:function(e,t,s){"use strict";s("7154")},b040:function(e,t,s){"use strict";s("8319")},b4fa:function(e,t,s){},baf7:function(e,t,s){},bc11:function(e,t,s){},be50:function(e,t,s){"use strict";var i=s("1387"),a={name:"AudioPlayer",props:{fileObject:{type:Object,required:!0},onDownload:{type:Function,default:()=>{}}},data:()=>({isPlaying:!1,player:void 0,slider:void 0,seekCircle:void 0,playedDuration:"00:00",totalDuration:"00:00"}),mounted(){this.init()},methods:{init(){let{slider:e,slider_value:t,thumb:s,player:i}=this.$refs;this.slider=e,this.sliderVal=t,this.player=i,this.seekCircle=s},togglePlay(){this.isPlaying?this.pause():i.a.play(this.player)},pause(){i.a.stop(this.player)},seekMouseDown(e){e.preventDefault();let t=this.getOffsetX(e);this.setSeekPercentage(t),this.slider.addEventListener("mousemove",this.seekMouseMove),this.$el.addEventListener("mouseup",this.mouseUp)},seekMouseMove(e){e.preventDefault();let t=this.getOffsetX(e);this.setSeekPercentage(t)},setSeekPercentage(e){let t=this.getSliderWidth(e,this.slider);this.paintSeekBarWidth(t);let s=this.player.duration;s&&(this.player.currentTime=s*(t/100))},getSliderWidth(e,t){let s=e/t.clientWidth*100;return s>100?100:s<0?0:s},mouseUp(e){e.preventDefault(),this.slider.removeEventListener("mousemove",this.seekMouseMove),this.$el.removeEventListener("mouseup",this.mouseUp)},onTimeUpdate(){this.paintSeekBarWidth(this.getSeekPercentage()),(()=>{this.playedDuration=this.secondsToMinutes(this.player.currentTime)})()},onDurationChange(){this.totalDuration=this.secondsToMinutes(this.player.duration)},onEnded(){this.isPlaying=!1,this.pause()},paintSeekBarWidth(e){let t=e+"%";this.sliderVal.style.width=t,this.seekCircle.style.left=t},getSeekPercentage(){let{currentTime:e,duration:t}=this.player;return(100*parseFloat(e/t)).toFixed(2)},secondsToMinutes(e){if("Infinity"!=e)return new Date(1e3*e).toISOString().substr(14,5)},getOffsetX(e){let t=e.target,s=e.offsetX,i=this.seekCircle;return i&&i.contains(t)&&(s+=t.offsetLeft),s}},beforeDestroy(){this.isPlaying&&this.pause()}},n=a,o=(s("e3e8"),s("2877")),r=Object(o.a)(n,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"siq-voice-audio flexC"},[s("div",{directives:[{name:"title",rawName:"v-title",value:e.isPlaying?"av.pause":"av.play",expression:"isPlaying? 'av.pause' : 'av.play'"},{name:"a11y",rawName:"v-a11y:box",arg:"box"},{name:"aria",rawName:"v-aria",value:{label:e.isPlaying?"av.pause":"av.play"},expression:"{label: isPlaying ? 'av.pause' : 'av.play'}"}],staticClass:"siq-voice-control curP clr3",attrs:{"data-zsqa":"audio_play"},on:{click:e.togglePlay}},[s("icon",{staticClass:"ifont14",class:e.isPlaying?"siqico-pause":"siqico-play"})],1),s("div",{staticClass:"w100"},[s("span",{staticClass:"font14"},[e._v(e._s(e.fileObject.name))]),s("div",{staticClass:"flexC"},[s("div",{staticClass:"range posrel"},[s("span",{ref:"slider",staticClass:"range-path",attrs:{"data-zsqa":"audio_seeker"},on:{mousedown:function(t){return t.preventDefault(),e.seekMouseDown(t)}}},[s("span",{ref:"slider_value",staticClass:"range-val"}),s("span",{ref:"thumb",staticClass:"range-handle"})]),s("div",{staticClass:"range-point-wrp"},[s("span",{attrs:{id:"sqico-played-duration"}},[e._v(e._s(e.playedDuration))]),s("span",{attrs:{id:"sqico-total-duration"}},[e._v(e._s(e.totalDuration))])])]),s("audio",{ref:"player",attrs:{src:e.fileObject.url,crossorigin:"anonymous"},on:{play:function(t){e.isPlaying=!0},pause:function(t){e.isPlaying=!1},timeupdate:e.onTimeUpdate,durationchange:e.onDurationChange,ended:e.onEnded}}),s("div",{directives:[{name:"a11y",rawName:"v-a11y:box",arg:"box"},{name:"aria",rawName:"v-aria",value:{label:"siq.download"},expression:"{label: 'siq.download'}"}],staticClass:"voice-dwnld-cont clr6",attrs:{"data-zsqa":"audio_download"},on:{click:function(t){return t.stopPropagation(),e.onDownload(t)}}},[s("icon",{staticClass:"siqico-dwnld ifont14",attrs:{title:e.$doI18N("siq.download")}})],1)])])])},[],!1,null,"3f88365c",null);t.a=r.exports},c22f:function(e,t,s){},c24c:function(e,t,s){},c25b:function(e,t,s){},c5f4:function(e,t,s){},c7b0:function(e,t,s){},cdb6:function(e,t,s){"use strict";var i={name:"MessageBubbleWrap",props:{listeners:Object}},a=(s("57b8"),s("2877")),n=Object(a.a)(i,function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",e._g({staticClass:"chat-bubble"},e.listeners),[e._t("default")],2)},[],!1,null,null,null);t.a=n.exports},ce23:function(e,t,s){"use strict";var i={props:{onClick:Function}},a=s("2877"),n=Object(a.a)(i,function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",e._g({staticClass:"flex fdirection ovrlfw-hid h100 posrel",attrs:{"data-zsqa":"message_window"}},e.onClick?{click:e.onClick}:{}),[e._t("default")],2)},[],!1,null,null,null);t.a=n.exports},ce30:function(e,t,s){"use strict";s("a7f5")},cec9:function(e,t,s){},d05b:function(e,t,s){"use strict";var i=s("2f62"),a=s("0970"),n=s("2c40"),o=s("8db4"),r=s("7942"),l=s("2e16");t.a={props:{messageId:{type:String,required:!0}},data:()=>({time:"",isVisitorMsg:"",meta:{}}),computed:{...Object(i.d)("conversationstore",{chatId:"activeChatId"}),isBotWidget(){let{meta:e}=this;return!!(e.input_card||e.display_card||l.a.includes(e.type||""))},isTriggerMsg(){return Object(o.h)(this.messageDetail)},isSurveyMsg(){return"survey_input_card"===this.meta.type},displayText(){let{messageDetail:{message:e}}=this;return e.text||e.comment||e.message},fileData(){var e,t;const s=null===(e=this.messageDetail)||void 0===e||null===(e=e.message)||void 0===e?void 0:e.file,i=null===(t=this.messageDetail)||void 0===t?void 0:t.snippet;return"chat_attachment"===(null==s?void 0:s.att_type)&&i?{...s,snippet:i}:s},replyDetail(){return this.messageDetail.reply_to},status(){return this.messageDetail.status},isSending(){return this.status===a.q.sending},messageTime(){return Object(r.e)(this.time)},messageDetail(){return this.quotedDetail||Object(n.c)(this.chatId,this.messageId)},id(){return this.messageDetail.id}},created(){this.updateMessageDetail()},methods:{updateMessageDetail(){let e=this.messageDetail;this.time=e.time,this.meta=("string"==typeof e.meta?JSON.parse(e.meta):e.meta)||{},e.messageTime=this.messageTime;try{this.isVisitorMsg=Object(o.i)(e.sender.id)&&!Object(o.h)(e)}catch(t){let s={chatId:this.chatId,messageId:this.messageId,detail:e};this.$dispatchLog({sub:"sender id missing in updateMessageDetail",log:JSON.stringify(s)})}}},watch:{id:"updateMessageDetail"}}},d09b:function(e,t,s){"use strict";s("2d27")},d59b:function(e,t,s){"use strict";var i=s("2949"),a={name:"ConversationRatingEmojiList",props:{rating:{type:String,default:""},showTitle:{type:Boolean,default:!1},handleRating:Function},data(){let e=this.$doI18N;return{reactions:[{key:"happy",title:e("siq.happy")},{key:"neutral",title:e("siq.neutral")},{key:"sad",title:e("siq.sad")}]}},methods:{onRatingClick(e){e.key!==this.rating&&this.handleRating(e)}},components:{ConversationRatingEmoji:i.a}},n=a,o=(s("3437"),s("2877")),r=Object(o.a)(n,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex"},e._l(e.reactions,function(t,i){var a=t.key,n=t.title;return s("ConversationRatingEmoji",{directives:[{name:"a11y",rawName:"v-a11y:box",arg:"box"},{name:"aria",rawName:"v-aria:button",value:{label:a},expression:"{ label : key }",arg:"button"}],key:a,staticClass:"rating-emoji-wrap",class:{"mini-view":!(n&&e.showTitle)},attrs:{emojiKey:a,isSelected:a===e.rating,"data-zsqa":a},nativeOn:{click:function(t){return e.onRatingClick(e.reactions[i])}},scopedSlots:e._u([{key:"post-slot",fn:function(){return[n&&e.showTitle?s("span",{staticClass:"clr6 smiley-title"},[e._v(" "+e._s(e._f("i18n")(n))+" ")]):e._e()]},proxy:!0}],null,!0)})}),1)},[],!1,null,null,null);t.a=r.exports},e0a5:function(e,t,s){},e307:function(e,t,s){},e3e8:function(e,t,s){"use strict";s("fec4")},e5ce:function(e,t,s){"use strict";s("03df")},e707:function(e,t,s){"use strict";s("c5f4")},eaa8:function(e,t,s){"use strict";s("bc11")},eb4b:function(e,t,s){},ed8b:function(e,t,s){"use strict";s.d(t,"a",function(){return a});var i=s("eada");const a={methods:{showArticle(e){if("zohodesk"===e.source)return Object(i.a)(e.url);this.$openResource(e.id||Object.keys(e)[0],e.language_code||"","article")},openResourceDialog(e,t){this.$openResource(e,t,"article")},showErrorBanner(){this.$showBanner(this.$doI18N("resource.notavail",this.$doI18N("faq.article")))},updateViewCount(e){return this.initApi("updateArticleViewCount",{...e,module:"article"})}}}},f02b:function(e,t,s){},f6fb:function(e,t,s){"use strict";var i=s("76c4"),a={name:"AttachmentFileIcon",props:{fileName:{type:String,required:!0},fontClass:String},computed:{iconClass(){return Object(i.b)(this.fileName)}}},n=(s("6e90"),s("2877")),o=Object(n.a)(a,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flexM h100",attrs:{"data-zsqa":"attachment_icon"}},[s("icon",{staticClass:"siqcw-file-icon clr8-dark",class:[e.iconClass,e.fontClass]})],1)},[],!1,null,"6d322f76",null);t.a=o.exports},fdd8:function(e,t,s){},fec4:function(e,t,s){}}]);